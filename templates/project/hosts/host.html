<!DOCTYPE html>
<html lang="en">
{% include 'header.html' %}
<body>
<div id="segment_id">
    {% include 'menu.html' %}
    <script>
        $(document).ready(function () {

            $('#hosts_tab_names .item').tab({
                onVisible() {
                    $('#host_menu').sticky('refresh');
                    $('#sidebar').sticky('refresh');
                },
                history: true,
                historyType: 'hash'
            });

            service_dropdown = $('#services_list').dropdown();

            $('#os_list').dropdown();

            $('#issue_hostname').dropdown();

            $('#issue_service').dropdown();

            $('#port_new_creds').dropdown();

            $('#hostname_new_creds').dropdown();

            $('#ports_list').DataTable(
                {
                    "order": [[0, "asc"]],
                    "iDisplayLength": -1,
                    "searching": false,
                    "paging": false,
                    "info": false,
                    "padding": false,
                    "aocolumnDefs": [
                        {
                            "sType": "num"
                        },
                        {
                            "sType": "string"
                        },
                        {
                            "sType": "string"
                        },
                        null,
                        null
                    ],
                    "columnDefs": [
                        {
                            "orderable": false,
                            targets: 3
                        },
                        {
                            "orderable": false,
                            targets: 4
                        }
                    ]
                }
            );

            $('#hostnames_list').DataTable(
                {
                    "order": [[0, "asc"]],
                    "iDisplayLength": -1,
                    "searching": false,
                    "paging": false,
                    "info": false,
                    "padding": false,
                    "aocolumnDefs": [
                        {
                            "sType": "string"
                        },
                        {
                            "sType": "string"
                        },
                        null
                    ],
                    "columnDefs": [
                        {
                            "orderable": false,
                            targets: 2
                        }
                    ]
                }
            );

            $('.message .close')
                .on('click', function () {
                    $(this)
                        .closest('.message')
                        .transition('fade')
                    ;
                });
            $('#host_menu').sticky({context: '#host_tabs'});

            var issues_table = $('#issues_list').DataTable({
                "order": [[3, "desc"]],
                "iDisplayLength": -1,
                "searching": false,
                "paging": false,
                "info": false,
                "padding": false,
                'columnDefs': [{
                    'targets': 5,
                    'searchable': false,
                    'orderable': false,
                }]
            });

            $('#creds_list').DataTable({
                "order": [[0, "desc"]],
                "iDisplayLength": -1,
                "searching": false,
                "paging": false,
                "info": false,
                "padding": false,
                'columnDefs': [{
                    'targets': 5,
                    'searchable': false,
                    'orderable': false,
                }]
            });

            rows = document.getElementsByClassName('issue_row');
            i = 0;
            while (i < rows.length) {
                cvss = parseFloat(rows[i].children[3].innerText);
                console.log(cvss);
                if (cvss == 0) {
                    rows[i].style.backgroundColor = '#c0f7ff';
                } else if (cvss <= 3.9) {
                    rows[i].style.backgroundColor = '#c3ffcd';
                } else if (cvss <= 6.9) {
                    rows[i].style.backgroundColor = '#fffdc2';
                } else if (cvss <= 8.9) {
                    rows[i].style.backgroundColor = '#f3c375';
                } else {
                    rows[i].style.backgroundColor = '#ffb2b2';
                }
                i++;
            }

        });

        function submit_creds() {
            var
                login = document.getElementById('login_new_creds').value,
                hash = document.getElementById('hash_new_creds').value,
                cleartext = document.getElementById('cleartext_new_creds').value,
                comment = document.getElementById('comment_new_creds').value;
            var e = document.getElementById('port_new_creds');
            if (e.selectedIndex === -1) {
                alert('Need to set credentials port!');
                return;
            }
            var port_id = e.options[e.selectedIndex].value;
            e = document.getElementById('hostname_new_creds');
            var hostname_id = e.options[e.selectedIndex].value;

            var send_data = {
                "login": login,
                "password_hash": hash,
                "cleartext_password": cleartext,
                "comment": comment,
                "csrf_token": "{{csrf_token()}}"
            };

            if (hostname_id === "0") {
                send_data['ip_port-0'] = port_id;
            } else {
                send_data['host_port-0'] = port_id + ':' + hostname_id;
            }
            $.ajax({
                type: "POST",
                url: "/project/{{current_project['id']}}/credentials/new_creds",
                data: send_data,
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded"
                },
                cache: false
            });
            window.location.reload(true);
        }

        function delete_prompt(func, message) {
            if (confirm(message))
                return true;
            return false;
        };

        function copy_data(loop_index) {
            document.getElementById("port").value = document.getElementById("port_num_" + loop_index).textContent;
            document.getElementById("port_descr").value = document.getElementById("port_description_" + loop_index).textContent;
            document.getElementById("service_text").value = "";
            service_text = document.getElementById("port_service_" + loop_index).textContent;
            if (!service_text) {
                service_text = 'other';
            }

            if (!service_field) {
                select = document.getElementById('services_list');
                var service_field = document.createElement('option');
                service_field.setAttribute("id", "port_service");
                select.prepend(service_field);
            }
            service_field.value = service_text;
            service_field.textContent = service_text;
            service_field.selected = 'selected';

            $('#services_list').dropdown('refresh');

            var element = document.getElementById('port_edit_form');
            element.scrollIntoView({
                block: 'start',
                behavior: 'smooth'
            });
        }

        function copy_hostname(loop_index) {
            document.getElementById("hostname_field").value = document.getElementById("hostname_" + loop_index).textContent;
            document.getElementById("hostname_comment").value = document.getElementById("hostname_comment_" + loop_index).textContent;
            var element = document.getElementById('add_hostname_form');
            element.scrollIntoView({
                block: 'start',
                behavior: 'smooth'
            });
        }
    </script>
    <style>
        tr.odd {
            background-color: #fffdc2;
        }

        tr.even {
            background-color: #c3ffcd;
        }

        #ports_list {
            word-wrap: break-word;
        }
    </style>
    <div class="ui grid">
        <div class="ui column" style="width: 75px; padding-top: 50px;">
            {% include 'project/sidebar.html' %}
        </div>
        <div class="ui column" style="width: calc(100% - 75px)">
            <h1 class="ui dividing header">Host: {{ escape(current_host['ip']) }}</h1>
            <div class="ui container" style="width: 100%">
                <div class="ui grid" id="host_page">
                    <div class="column" style="width: 170px;">
                        <div class="ui sticky" id="host_menu">
                            <div class="ui vertical fluid tabular menu" id="hosts_tab_names">
                                <a class="item active" data-tab="ports">
                                    Ports<i class="fork icon"></i>
                                </a>
                                <a class="item" data-tab="hostnames">
                                    Hostnames<i class="globe icon"></i>
                                </a>
                                <a class="item" data-tab="issues">
                                    Issues<i class="bug icon"></i>
                                </a>
                                <a class="item" data-tab="credentials">
                                    Credentials<i class="key icon"></i>
                                </a>
                                <a class="item" data-tab="files">
                                    Files<i class="open folder icon"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="stretched column" style="width: calc(100% - 200px)" id="host_tabs">
                        <div class="ui tab active" data-tab="ports">
                            {% set ports = db.select_host_ports(current_host['id']) %}
                            <table class="ui table" id="ports_list">
                                <thead>
                                <tr>
                                    <th>port</th>
                                    <th>service</th>
                                    <th>description</th>
                                    <th>threats</th>
                                    <th style="width:135px;">action</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for current_port in ports %}
                                    <tr>
                                        <td id="port_num_{{ loop.index }}" data-order="{{ current_port['port'] }}">{{ current_port['port'] }}/{% if current_port['is_tcp'] %}tcp{% else %}udp{% endif %}</td>
                                        <td id="port_service_{{ loop.index }}">{{ escape(current_port['service']) }}</td>
                                        <td id="port_description_{{ loop.index }}" style="word-break: break-all; white-space:pre-wrap;">{{ escape(current_port['description']) }}</td>
                                        <td>
                                            {% set threats = db.select_port_issues_stats(current_port['id']) %}
                                            {% if threats['critical'] %}
                                                <i class="warning circle big red icon"></i>
                                            {% endif %}
                                            {% if threats['high'] %}
                                                <i class="warning circle big orange icon"></i>
                                            {% endif %}
                                            {% if threats['medium'] %}
                                                <i class="warning circle big yellow icon"></i>
                                            {% endif %}
                                            {% if threats['low'] %}
                                                <i class="warning circle big green icon"></i>
                                            {% endif %}
                                            {% if threats['info'] %}
                                                <i class="warning circle big blue icon"></i>
                                            {% endif %}
                                        </td>
                                        <td style="width:135px;">
                                            <form style="width:135px;" method="post" action="/project/{{ current_project['id'] }}/host/{{ current_host['id'] }}/#/ports" onsubmit="return delete_prompt(this,'Are you sure to delete port {{ escape(current_port['port']) }}?')">
                                                <input type="hidden" name="delete_port" value="1"/>
                                                <input type="hidden" name="port_id" value="{{ current_port['id'] }}"/>
                                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                                <button type="button" class="ui vertical animated button purple" onclick="copy_data('{{ loop.index }}')">
                                                    <div class="hidden content">Edit</div>
                                                    <div class="visible content">
                                                        <i class="edit icon"></i>
                                                    </div>
                                                </button>
                                                <button type="submit" class="ui vertical animated button red">
                                                    <div class="hidden content">Delete</div>
                                                    <div class="visible content">
                                                        <i class="trash icon"></i>
                                                    </div>
                                                </button>
                                            </form>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                            <h3 class="ui dividing header">Edit/Create port:</h3>
                            <form class="ui form" method="post" action="/project/{{ current_project['id'] }}/host/{{ current_host['id'] }}/#/ports" id="port_edit_form">
                                <input type="hidden" name="add_port" value="1"/>
                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                <div class="four fields">
                                    <div class="ui field">
                                        <label>Port number:</label>
                                        <input placeholder="80/tcp" name="port" id="port" required>
                                    </div>
                                    <div class="ui field">
                                        <label>Port service:</label>
                                        <div class="ui field">
                                            <select class="ui dropdown selection search" name="service" id="services_list">
                                                <option value="http" selected>HTTP</option>
                                                <option value="https">HTTPS</option>
                                                <option value="dns">DNS</option>
                                                <option value="ftp">FTP</option>
                                                <option value="telnet">Telnet</option>
                                                <option value="other">Other</option>
                                            </select>
                                        </div>
                                        <label>or</label>
                                        <input placeholder="Other protocol" name="service_text" id="service_text">
                                    </div>
                                    <div class="ui field" style="width:calc(50% - 130px);">
                                        <label>Port information:</label>
                                        <textarea placeholder="Information about service" name="description" id="port_descr"></textarea>
                                    </div>
                                    <div class="ui field" style="width:130px">
                                        <button type="submit" name="Submit" value="Submit" class="ui button blue" style="margin-top:24px;"><i class="upload icon"></i>Update</button>
                                    </div>
                                </div>
                            </form>
                            {% if add_port_errors is defined and add_port_errors %}
                                <div class="ui error message visible">
                                    <i class="close icon"></i>
                                    <div class="header">
                                        There were some errors with credentials
                                    </div>
                                    <ul class="list">
                                        {% for error in add_port_errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            {% endif %}
                        </div>
                        <div class="ui tab" data-tab="hostnames">
                            <table class="ui table" id="hostnames_list">
                                <thead>
                                <tr>
                                    <th>hostname</th>
                                    <th>description</th>
                                    <th style="width:135px;">action</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% set hostnames = db.select_ip_hostnames(current_host['id']) %}
                                {% for hostname in hostnames %}
                                    <tr>
                                        <td id="hostname_{{ loop.index }}">{{ escape(hostname['hostname']) }}</td>
                                        <td id="hostname_comment_{{ loop.index }}">{{ escape(hostname['description']) }}</td>
                                        <td style="width:135px;">
                                            <form style="width:135px;" method="post" action="/project/{{ current_project['id'] }}/host/{{ current_host['id'] }}/#/hostnames" onsubmit="return delete_prompt(this,'Are you sure to delete hostname {{ escape(hostname['hostname']) }}?')">
                                                <input type="hidden" name="delete_hostname" value="1"/>
                                                <input type="hidden" name="hostname_id" value="{{ hostname['id'] }}">
                                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                                <button type="button" class="ui vertical animated button purple" onclick="copy_hostname('{{ loop.index }}');">
                                                    <div class="hidden content">Edit</div>
                                                    <div class="visible content">
                                                        <i class="edit icon"></i>
                                                    </div>
                                                </button>
                                                <button type="submit" class="ui vertical animated button red">
                                                    <div class="hidden content">Delete</div>
                                                    <div class="visible content">
                                                        <i class="trash icon"></i>
                                                    </div>
                                                </button>
                                            </form>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                            <h3 class="ui dividing header">Edit/Create hostname:</h3>
                            <form id="add_hostname_form" class="ui form" method="post" action="/project/{{ current_project['id'] }}/host/{{ current_host['id'] }}/#/hostnames">
                                <input type="hidden" name="add_hostname" value="1"/>
                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                <div class="three fields">
                                    <div class="ui field">
                                        <label>Hostname:</label>
                                        <input placeholder="google.com" name="hostname" id="hostname_field" required>
                                    </div>
                                    <div class="ui field">
                                        <label>Comment:</label>
                                        <input placeholder="Main domain of" name="comment" id="hostname_comment">
                                    </div>
                                    <div class="ui field">
                                        <button type="submit" name="Submit" value="Submit" class="ui button blue" style="margin-top:24px;"><i class="upload icon"></i>Submit</button>
                                    </div>
                                </div>
                            </form>
                            {% if add_hostname_errors is defined and add_hostname_errors %}
                                <div class="ui error message visible">
                                    <i class="close icon"></i>
                                    <div class="header">
                                        There were some errors with hostname
                                    </div>
                                    <ul class="list">
                                        {% for error in add_hostname_errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            {% endif %}
                        </div>
                        <div class="ui tab" data-tab="issues">
                            <table id="issues_list" class="ui table" style="width: 100%">
                                <thead>
                                <tr id="table_header">
                                    <th style="width: 200px;"><h4>name</h4></th>
                                    <th style="width: 800px;"><h4>description</h4></th>
                                    <th style="min-width: 300px;"><h4>services</h4></th>
                                    <th style="min-width: 100px;"><h4>CVSS</h4></th>
                                    <th><h4>status</h4></th>
                                    <th style="width:135px;"><h4>action</h4></th>
                                </tr>
                                </thead>
                                <tbody>
                                {% set issues = db.select_host_issues(current_host['id']) %}
                                {% for issue in issues %}
                                    <tr class="issue_row">
                                        <td style="word-break: break-all; white-space:pre-wrap;"><b>{{ escape(issue['name']) }}</b></td>
                                        <td style="word-break: break-all; white-space:pre-wrap;">{{ escape('\n'.join(issue['description'].split('\n')[:5])) }}</td>
                                        <td>
                                            <ul class="ui list">
                                                {% set addresses = json_unpack(issue['services']) %}
                                                {% set counter = [0] %}
                                                {% for port_id in addresses %}
                                                    {% set port = db.select_port(port_id)[0] %}
                                                    {% for host in addresses[port_id] %}
                                                        {% if counter[0] < 5 %}
                                                            {% if host=="0" %}
                                                                {% set ip = db.select_host_by_port_id(port_id)[0] %}
                                                                <li>
                                                                    {{ escape(ip['ip']) }}{% if port['port'] != 0 %}:
                                                                        {{ escape(port['port']) }}{% endif %}</li>
                                                            {% else %}
                                                                {% set hostname = db.select_hostname(host)[0] %}
                                                                <li>
                                                                    {{ escape(hostname['hostname']) }}{% if port['port'] != 0 %}:
                                                                        {{ escape(port['port']) }}{% endif %}</li>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% if counter.append(counter.pop() + 1) %}{% endif %}
                                                    {% endfor %}
                                                {% endfor %}
                                                {% if counter[0] >5 %}
                                                    ...<br/>
                                                    {{ counter[0] }} hosts at all!
                                                {% endif %}
                                            </ul>
                                        </td>
                                        <td>{{ escape(issue['cvss']) }}</td>
                                        <td>{{ escape(issue['status']) }}</td>
                                        <td style="width:135px;">
                                            <form style="width:135px;" class="ui form" method="post" action="/project/{{ current_project['id'] }}/host/{{ current_host['id'] }}/" onsubmit="return delete_prompt(this,'Are you sure to delete issue {{ escape(issue['name']) }}?')">
                                                <input type="hidden" name="delete_host_issue" value="1"/>
                                                <input type="hidden" name="issue_id" value="{{ issue['id'] }}">
                                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                                <a type="button" class="ui vertical animated button blue" target="_blank" rel="noopener noreferrer" href="/project/{{ current_project['id'] }}/issue/{{ issue['id'] }}/">
                                                    <div class="hidden content">Open</div>
                                                    <div class="visible content">
                                                        <i class="share icon"></i>
                                                    </div>
                                                </a>
                                                <button type="submit" class="ui vertical animated button red">
                                                    <div class="hidden content">Delete</div>
                                                    <div class="visible content">
                                                        <i class="trash icon"></i>
                                                    </div>
                                                </button>
                                            </form>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                            <h3 class="ui dividing header">Create Issue:</h3>
                            <form class="ui form" action="/project/{{ current_project['id'] }}/new_issue" method="get">
                                <div class="three fields">
                                    <div class="ui field">
                                        <label>Port:</label>
                                        <select class="ui dropdown selection search" name="service" id="issue_service">
                                            {% for current_port in db.select_host_ports(current_host['id'], full=True) %}
                                                <option value="{{ current_port['id'] }}" {% if current_port['port'] == 0 %}selected{% endif %}>{% if current_port['port'] == 0 %}Whole host{% else %}{{ current_port['port'] }}/{% if current_port['is_tcp'] %}tcp{% else %}udp{% endif %}{% endif %}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="ui field">
                                        <label>Host/Hostname:</label>
                                        <select class="ui dropdown selection search" name="hostname" id="issue_hostname">
                                            <option value="0">{{ current_host['ip'] }}</option>
                                            {% for hostname in hostnames %}
                                                <option value="{{ hostname['id'] }}">{{ escape(hostname['hostname']) }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="ui field">
                                        <button type="submit" name="Submit" value="Submit" class="ui button blue" style="margin-top:24px;"><i class="plus icon"></i>Add new vulnerability</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="ui tab" data-tab="credentials">
                            <table id="creds_list" class="ui table">
                                <thead>
                                <tr id="table_header">
                                    <th><h4>login / email</h4></th>
                                    <th><h4>hash</h4></th>
                                    <th><h4>password</h4></th>
                                    <th><h4>comment</h4></th>
                                    <th><h4>service</h4></th>
                                    <th><h4>action</h4></th>
                                </tr>
                                </thead>
                                <tbody>
                                {% set credentials = db.select_creds_by_host(current_project['id'], current_host['id']) %}
                                {% for current_cred in credentials %}
                                    <tr>
                                        <td>{{ current_cred['login'] }}</td>
                                        <td>{{ current_cred['hash'] }}</td>
                                        <td>{{ current_cred['cleartext'] }}</td>
                                        <td>{{ current_cred['description'] }}</td>
                                        <td>
                                            <ul class="ui list">
                                                {% set addresses = json_unpack(current_cred['services']) %}
                                                {% for port_id in addresses %}
                                                    {% set port = db.select_port(port_id)[0] %}
                                                    {% for host in addresses[port_id] %}
                                                        {% if host=="0" %}
                                                            {% set ip = db.select_host_by_port_id(port_id)[0] %}
                                                            <li>{{ escape(ip['ip']) }}{% if port['port'] != 0 %}:{{ escape(port['port']) }}{% endif %}</li>
                                                        {% else %}
                                                            {% set hostname = db.select_hostname(host)[0] %}
                                                            <li>{{ escape(hostname['hostname']) }}{% if port['port'] != 0 %}:{{ escape(port['port']) }}{% endif %}</li>
                                                        {% endif %}
                                                    {% endfor %}
                                                {% endfor %}
                                            </ul>
                                        </td>
                                        <td>
                                            <a style="float:left" type="button" class="ui vertical animated button blue" target="_blank" rel="noopener noreferrer" href="/project/{{ current_project['id'] }}/credentials/{{ current_cred['id'] }}/">
                                                <div class="hidden content">Open</div>
                                                <div class="visible content">
                                                    <i class="share icon"></i>
                                                </div>
                                            </a>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                            <h3 class="ui dividing header">Add Credentials:</h3>
                            <form onsubmit="submit_creds(); return false;" class="ui form">
                                <div class="five fields">
                                    <div class="ui field">
                                        <div class="ui field">
                                            <label>Login:</label>
                                            <input placeholder="admin" name="login" id="login_new_creds" required>
                                        </div>
                                        <div class="ui field">
                                            <label>Service:</label>
                                            <select class="ui dropdown selection search" id="port_new_creds">
                                                {% for current_port in db.select_host_ports(current_host['id'], full=True) %}
                                                    <option value="{{ current_port['id'] }}" {% if current_port['port'] == 0 %}selected{% endif %}>{% if current_port['port'] == 0 %}Whole host{% else %}{{ current_port['port'] }}/{% if current_port['is_tcp'] %}tcp{% else %}udp{% endif %}{% endif %}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="ui field">
                                        <div class="ui field">
                                            <label>Password hash:</label>
                                            <input placeholder="21232f297a57a5a743894a0e4a801fc3" name="hash" id="hash_new_creds">
                                        </div>
                                        <div class="ui field">
                                            <label>Host/Hostname:</label>
                                            <select class="ui dropdown selection search" name="hostname" id="hostname_new_creds">
                                                <option value="0">{{ current_host['ip'] }}</option>
                                                {% for hostname in hostnames %}
                                                    <option value="{{ hostname['id'] }}">{{ escape(hostname['hostname']) }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="ui field">
                                        <label>Cleartext password:</label>
                                        <input placeholder="Qwerty1234" name="cleartext" id="cleartext_new_creds">
                                    </div>
                                    <div class="ui field">
                                        <label>Comment:</label>
                                        <input placeholder="Default password of ..." name="comment" id="comment_new_creds">
                                    </div>
                                    <div class="ui field">
                                        <button type="submit" name="Submit" value="Submit" class="ui button blue" style="margin-top:24px;"><i class="plus icon"></i>Add</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="ui tab" data-tab="files">TODO later</div>
                        <div style="height:200px"></div>
                        <div class="host_footer" style="position: fixed; bottom: 0; width:calc(100% - 300px); background-color: white; margin-right: 150px;z-index: 3;">
                            <h3 class="ui dividing header" style="margin-top:15px;">Host information:</h3>
                            <form class="ui form" action="/project/{{ current_project['id'] }}/host/{{ current_host['id'] }}/" method="post" onsubmit="return delete_prompt(this,'Are you sure to edit or delete host?');">
                                <input type="hidden" name="update_description" value="1"/>
                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                                <div class="three fields">
                                    <div class="ui field">
                                        <label>Host comment:</label>
                                        <textarea placeholder="Example text" name="comment">{{ escape(current_host['comment']) }}</textarea>
                                    </div>
                                    <div class="ui field">
                                        {% set current_threats=json_unpack(current_host['threats']) %}
                                        <div class="grouped fields">
                                            <label>Threats:</label>
                                            <div class="field" style="margin-bottom:0px;margin-top:0px;">
                                                <div class="ui checkbox">
                                                    <input type="checkbox" name="threats-0" value="high" {% if 'high' in current_threats %} checked {% endif %}>
                                                    <label><i class="warning circle red icon"></i>High</label>
                                                </div>
                                            </div>
                                            <div class="field" style="margin-bottom:0px; margin-top:0px;">
                                                <div class="ui checkbox">
                                                    <input type="checkbox" name="threats-1" value="medium" {% if 'medium' in current_threats %} checked {% endif %}>
                                                    <label><i class="warning circle yellow icon"></i>Medium</label>
                                                </div>
                                            </div>
                                            <div class="field" style="margin-bottom:0px; margin-top:0px;">
                                                <div class="ui checkbox">
                                                    <input type="checkbox" name="threats-2" value="low" {% if 'low' in current_threats %} checked {% endif %}>
                                                    <label><i class="warning circle green icon"></i>Low</label>
                                                </div>
                                            </div>
                                            <div class="field" style="margin-bottom:0px; margin-top:0px;">
                                                <div class="ui checkbox">
                                                    <input type="checkbox" name="threats-3" value="info" {% if 'info' in current_threats %} checked {% endif %}>
                                                    <label><i class="warning circle blue icon"></i>Information</label>
                                                </div>
                                            </div>
                                            <div class="field" style="margin-bottom:0px; margin-top:0px;">
                                                <div class="ui checkbox">
                                                    <input type="checkbox" name="threats-4" value="check" {% if 'check' in current_threats %} checked {% endif %}>
                                                    <label><i class="help circle purple icon"></i>Need to check</label>
                                                </div>
                                            </div>
                                            <div class="field" style="margin-bottom:0px; margin-top:0px;">
                                                <div class="ui checkbox">
                                                    <input type="checkbox" name="threats-5" value="checked" {% if 'checked' in current_threats %} checked {% endif %}>
                                                    <label><i class="flag red icon"></i>Checked</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="ui field">
                                        <div class="ui field">
                                            <label>Operation system:</label>
                                            <select class="ui dropdown selection search" name="os" id="os_list">
                                                <option value="" selected>other</option>
                                                <option value="Windows XP">Windows XP</option>
                                                <option value="Windows 7">Windows 7</option>
                                                <option value="Windows 8">Windows 8</option>
                                                <option value="Windows 10">Windows 10</option>
                                                <option value="Windows Server 2008">Windows Server 2008</option>
                                                <option value="Window Server 2016">Window Server 2016</option>
                                                <option value="Window Server 2019">Window Server 2019</option>
                                                <option value="MacOS">MacOS</option>
                                                <option value="Ubuntu Linux">Ubuntu Linux</option>
                                                <option value="Debian Linux">Debian Linux</option>
                                                <option value="CentOS Linux">CentOS Linux</option>
                                                <option value="RedHat Linux">RedHat Linux</option>
                                            </select>
                                        </div>
                                        <label>or</label>
                                        <div class="ui field">
                                            <div class="ui input">
                                                <input type="text" name="os_input" placeholder="Windows 7" value="{{ current_host['os'] }}">
                                            </div>
                                        </div>
                                        <div class="ui field" style="margin-top:15px;">
                                            <button type="submit" name="Submit" value="Update" class="ui button purple"><i class="sync icon"></i>Update</button>
                                            <button type="submit" name="Submit" value="Delete" class="ui button red"><i class="trash icon"></i>Delete</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% include 'footer.html' %}
</div>
</div>
</body>
</html>