<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Sun Sep 06 2020 18:04:21 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5f5396b4acb00f08ce08266b" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-col w-col-11">
      <div>
        <div class="w-row">
          <div class="column-242 w-clearfix w-col w-col-6">
            <h1 class="heading-3">HTTP-Sniffer</h1>
          </div>
          <div class="w-col w-col-6">
            <div class="form-block-15 w-clearfix w-form">
              <form id="email-form" name="email-form" data-name="Email Form" class="form-8 w-clearfix" method="post" action="/project/{{current_project['id']}}/tools/http-sniffer/add">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                <input class="text-field-29 w-input" maxlength="256" name="name" data-name="Email" placeholder="Sniffer name" id="email" required="">
                <input type="submit" value="Add" data-wait="Please wait..." class="submit-button-28 w-button">
              </form>
              <div class="w-form-done">
                <div>Thank you! Your submission has been received!</div>
              </div>
              <div class="w-form-fail">
                <div>Oops! Something went wrong while submitting the form.</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div data-duration-in="300" data-duration-out="100" class="tabs-8 w-tabs">
        <div class="tabs-menu-7 w-clearfix w-tab-menu">
          {% set sniffers = db.select_project_http_sniffers(current_project['id']) %}
          {% for current_sniffer in sniffers %}
            <a data-w-tab="Tab {{loop.index}}" class="tab-link-tab-1-4 w-inline-block w-tab-link w--current">
              <div class="text-block-67">{{escape(current_sniffer['name'])}}</div>
            </a>
          {% endfor %}
        </div>
        <div class="tabs-content-6 w-tab-content">
          {% for current_sniffer in sniffers %}
          <div data-w-tab="Tab {{loop.index}}" class="tab-pane-tab-1-4 w-tab-pane w--tab-active">
            <div class="columns-62 w-row">
              <div class="column-239 w-col w-col-2">
                <div class="text-block-74">
                  <strong>Request URL:</strong>
                </div>
              </div>
              <div class="column-238 w-col w-col-9">
                <div class="text-block-73">http://127.0.0.1:5000/http_sniff/{{current_sniffer['id']}}/</div>
              </div>
              <div class="column-243 w-col w-col-1">
                <form action="/project/{{current_project['id']}}/tools/http-sniffer/{{current_sniffer['id']}}/delete" method="post">
                  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                  <input type="submit" value="Delete" class="button-51 w-button">
                </form>
              </div>
            </div>
            <div class="form-block-14 w-form">
              <form id="email-form-2" name="email-form-2" data-name="Email Form 2" action="/project/{{current_project['id']}}/tools/http-sniffer/{{current_sniffer['id']}}/edit" method="post">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                <div class="columns-64 w-row">
                  <div class="column-241 w-col w-col-3">
                    <div class="div-block-24">
                      <div class="text-block-84">
                        <strong>Status code:</strong>
                      </div>
                      <select id="field" name="status" class="w-select">
                        <option value="{{current_sniffer['status']}}">{{current_sniffer['status']}}</option>
                        <option value="200">200 - OK</option>
                        <option value="302">302 - Temporary Redirect</option>
                        <option value="301">301 - Permanent Redirect</option>
                        <option value="404">404 - Not Found</option>
                        <option value="410">410 - Gone</option>
                        <option value="500">410 - Internal Server Error</option>
                        <option value="503">503 - Service Unavailable</option>

                      </select>
                    </div>
                  </div>
                  <div class="w-col w-col-3">
                    <div class="container-4 w-container">
                      <div class="text-block-84">
                        <strong>Redirect URL:</strong>
                      </div>
                      <input type="text" class="w-input" maxlength="256" name="location" data-name="Redirect" placeholder="http://127.0.0.1/" id="Redirect" value="{{escape(current_sniffer['location'])}}">
                    </div>
                  </div>
                  <div class="w-col w-col-3">
                    <div class="div-block-25">
                      <div class="text-block-84">
                        <strong>Page body:</strong>
                      </div>
                      <input type="text" class="w-input" maxlength="256" name="body" data-name="Redirect 2" placeholder="Strange text" id="Redirect-2" value="{{escape(current_sniffer['body'])}}">
                    </div>
                  </div>
                  <div class="w-col w-col-3">
                    <input type="submit" name="submit" value="Update" data-wait="Please wait..." class="submit-button-29 w-button">
                    <input type="submit" name="submit" value="Clear" class="button-50 w-button">
                  </div>
                </div>
              </form>
            </div>
            <div class="div-block-23">
              {% set sniffer_requests = db.select_http_sniffer_requests(current_sniffer['id']) %}
              {% for current_request in sniffer_requests %}
              <div>
                {% if loop.index % 2 == 0 %}
                <div class="columns-61 w-row">
                {% else %}
                  <div class="columns-63 w-row">
                {% endif %}
                  <div class="w-col w-col-3">
                    <div class="text-block-71"><strong>Time:</strong> {{format_date(current_request['date']/1000, "%d.%m.%Y, %H:%M:%S")}}</div>
                    <div class="text-block-72"><strong>IP:</strong> {{current_request['ip']}}</div>
                  </div>
                  <div class="w-col w-col-9">
                    <div class="text-block-70" style="white-space: pre-lineÐ¶ word-break: break-all; white-space:pre-wrap;">{{current_request['request'].strip('\n')}}</div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
  {% include 'footer.html' %}
</body>
</html>