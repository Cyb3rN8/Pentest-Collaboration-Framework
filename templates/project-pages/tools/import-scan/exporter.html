<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Fri Aug 28 2020 14:08:41 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5f4837be65ca459f52f20487" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns w-row">
    {% include 'project-pages/menu.html' %}
      <div class="column w-col w-col-11">
      <div class="w-clearfix">
        <h1 class="heading-3">Exporter</h1>
        <div class="columns-55 w-row">
          <div class="w-col w-col-10">
            <div class="text-block-66">This module can export hosts with your rules. </div>
          </div>
          <div class="w-col w-col-2">
              <a href="#" class="button-42 w-button">Tutorial</a>
          </div>
        </div>
        <h3>Export filters</h3>
        <div class="form-block-13 w-form">
          <form id="email-form-3" name="email-form-3" data-name="Email Form 3" action="/project/{{current_project['id']}}/tools/exporter/" method="post">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <div class="columns-59 w-row">
              <div class="w-col w-col-2">
                  <select id="network_elem" name="network" class="select-field-11 w-select">
                    {% if 'network' in request.args and is_valid_uuid(request.args['network']) %}
                        {% set network = db.select_network(request.args.get('network'))[0] %}
                        <option value="{{network['id']}}">{{network['ip']}}/{{network['mask']}}</option>
                    {% endif %}
                    <option value="">All networks</option>
                    {% set networks = db.select_project_networks(current_project['id']) %}
                    {% for network in networks %}
                        <option value="{{network['id']}}">{{network['ip']}}/{{network['mask']}}</option>
                    {% endfor %}
                  </select>
                  <select id="port_elem" name="port" class="select-field-10 w-select">
                    {% if 'port' in request.args and request.args['port'] %}
                    <option value="{{escape(request.args['port'])}}">{{escape(request.args['port'])}}</option>
                    {% endif %}}
                    <option value="">All ports</option>
                    {% set ports = db.select_project_ports_unique(current_project['id']) %}
                    {% for port in ports %}
                        <option value="{{port['port']}}/{{'tcp' if port['is_tcp'] else 'udp'}}">{{port['port']}}/{{'tcp' if port['is_tcp'] else 'udp'}}</option>
                    {% endfor %}
                  </select>
              </div>
              <div class="column-236 w-col w-col-3">
                <div class="div-block-21">
                    <input type="text" class="text-field-23 w-input" maxlength="256" name="ip_hostname" data-name="Field 5" placeholder="ip / hostname" id="ip_hostname" {% if 'ip_hostname' in request.args %} value="{{escape(request.args['ip_hostname'])}}" {% endif %} >
                    <input type="text" class="text-field-25 w-input" maxlength="256" name="service" data-name="Field 8" placeholder="service" id="service_elem" {% if 'service' in request.args %} value="{{escape(request.args['service'])}}" {% endif %} >
                </div>
              </div>
              <div class="column-234 w-col w-col-3">
                <div class="div-block-20">
                    <input type="text" class="text-field-26 w-input" maxlength="256" name="issue_name" data-name="Issue Name" placeholder="Issue name" id="issue_name" {% if 'issue_name' in request.args %} value="{{escape(request.args['issue_name'])}}" {% endif %}>
                    <input type="text" class="text-field-24 w-input" maxlength="256" name="comment" data-name="Field 6" placeholder="host comment" id="comment_elem" {% if 'comment' in request.args %} value="{{escape(request.args['comment'])}}" {% endif %}>
                </div>
              </div>
              <div class="column-235 w-col w-col-2">
                    {% set threats = request.args.getlist('threat[]') %}
                    <label class="w-checkbox checkbox-field-12">
                        <input type="checkbox" id="high_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="high" {% if 'high' in threats %} checked {% endif %}>
                        <span class="w-form-label">High</span>
                    </label>
                    <label class="w-checkbox checkbox-field-13">
                        <input type="checkbox" id="medium_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="medium" {% if 'medium' in threats %} checked {% endif %}>
                        <span class="w-form-label">Medium</span>
                    </label>
                    <label class="w-checkbox checkbox-field-14">
                        <input type="checkbox" id="low_elem" name="threat" data-name="Checkbox 3" class="w-checkbox-input" value="low" {% if 'low' in threats %} checked {% endif %}>
                        <span class="w-form-label">Low</span>
                    </label>
                    <label class="w-checkbox checkbox-field-15">
                        <input type="checkbox" id="info_elem" name="threat" data-name="Checkbox 3" class="w-checkbox-input" value="info" {% if 'info' in threats %} checked {% endif %}>
                        <span class="w-form-label">Info</span>
                    </label>
                    <label class="w-checkbox checkbox-field-16">
                        <input type="checkbox" id="check_elem" name="threat" data-name="Checkbox 3" class="w-checkbox-input" value="check" {% if 'check' in threats %} checked {% endif %}>
                        <span class="w-form-label">Need to check</span>
                    </label>
                    <label class="w-checkbox checkbox-field-17">
                        <input type="checkbox" id="checked_elem" name="threat" data-name="Checkbox 3" class="w-checkbox-input" value="checked" {% if 'checked' in threats %} checked {% endif %}>
                        <span class="w-form-label">Checked</span>
                    </label>
              </div>
              <div class="w-col w-col-2">
                  <button type="button" value="View results" data-wait="Please wait..." class="submit-button-26 w-button" onclick="view_results('../../hosts/');">View results</button>
              </div>
            </div>
            <h3>Export rules</h3>
            <div class="w-row">
              <div class="w-col w-col-6">
                <div class="div-block-22 w-clearfix">
                    <label for="separator" class="field-label-28">Separator</label>
                    <input type="text" class="w-input" maxlength="256" name="separator" data-name="Field 10" value="[newline]" placeholder="[newline]" id="field-10">
                    <label for="separator" class="field-label-28">Filename</label>
                  <div class="columns-60 w-row">
                    <div class="w-col w-col-9">
                        <input type="text" class="w-input" maxlength="256" name="filename" data-name="Field 12" placeholder="export" value="export" id="field-12">
                    </div>
                    <div class="w-col w-col-3">
                        <select id="field-13" name="filetype" class="w-select">
                            <option value="txt">txt</option>
                            <!--
                            <option value="csv">csv</option>
                            <option value="xml">xml</option>
                            <option value="json">json</option>
                            -->
                        </select>
                    </div>
                  </div>
                  <input type="submit" value="Export" data-wait="Please wait..." class="submit-button-27 w-button">
                </div>
              </div>
              <div class="w-col w-col-6">
                <div class="w-clearfix">
                    <label for="separator" class="field-label-28">Hosts</label>
                    <select id="field-11" name="hosts_export" class="w-select">
                        <option value="ip&hostname">ip-addresses &amp; hostnames</option>
                        <option value="ip">ip-addresses</option>
                        <option value="hostname">hostnames</option>
                        <option value="ip&hostname_unique">hostnames &amp; ip without hostnames</option>
                    </select>
                    <label class="w-checkbox">
                        <input type="checkbox" id="checkbox-4" name="add_ports" data-name="Checkbox 4" class="w-checkbox-input" value="1">
                        <span class="w-form-label">Add ports (ONLY FOR TXT: 127.0.0.1:22\n...)</span>
                    </label>
                    <label class="w-checkbox checkbox-field-18">
                        <input type="checkbox" id="checkbox-5" name="open_in_browser" data-name="Checkbox 5" class="w-checkbox-input">
                        <span class="w-form-label">Just open file in browser</span>
                    </label>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  {% include 'footer.html' %}
</body>
</html>