<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Sat Oct 17 2020 08:14:39 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5f8aa4af9776623c49c3ecca" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns-43 w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-clearfix w-col w-col-11">
      <h1 class="heading-3">Shodan</h1>
      <div class="columns-55 w-row">
        <div class="w-col w-col-10">
          <div class="text-block-66">Shodan is a search engine that lets the user find specific types of computers (webcams, routers, servers, etc.) connected to the internet using a variety of filters.</div>
        </div>
        <div class="w-col w-col-2">
          <a href="https://www.shodan.io/" target="_blank" class="button-42 w-button">Official site</a>
        </div>
      </div>
      <div class="form-block-12 w-form">
        <form id="email-form" name="email-form" data-name="Email Form" class="form-7" method="post" action="/project/{{current_project['id']}}/tools/shodan/">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
          <div class="columns-56 w-row">
            <div class="column-232 w-col w-col-6">
              <div class="div-block-19">
                <label for="name" class="field-label-29">ip-address</label>
                <input type="text" class="text-field-20 w-input" maxlength="256" name="ip" data-name="Name" placeholder="8.8.8.8" id="name">
                <label for="name" class="field-label-29">or select hosts (careful! 1 host=1sec delay)</label>
                <input type="hidden" id="hosts_hidden" name="hosts" value="">
                <select id="hosts_elem" multiple="multiple" class="form-control">
                    {% set hosts = db.select_project_hosts(current_project['id']) %}
                    {% for host in hosts %}
                        <option value="{{escape(host['ip'])}}"> {{escape(host['ip'])}}</option>
                    {% endfor %}
                </select>
                <script>
                    $(function() {
                        $('#hosts_elem').change(function() {
                            document.getElementById("hosts_hidden").value = trimChar($(this).val().join(','),',');
                            console.log($(this).val());
                        }).multipleSelect({
                            width: '100%',
                            placeholder: 'Hosts'
                        });
                    });
                </script>
                <style>
                  .ms-parent {
                    max-width: 300px}
                </style>
                  <label for="name" class="field-label-29">or select networks with ASN </br> (max 1000 ip import + 1/100 month credits)</label>
                <input type="hidden" id="network_elem_hidden" name="networks" value="">
                <select id="network_elem" multiple="multiple" class="form-control">
                    {% set networks = db.select_project_networks(current_project['id']) %}
                    {% for network in networks %}
                        {% if network['asn'] and network['asn'] > 0 %}
                            <option value="{{network['id']}}" > {{network['ip']}}/{{network['mask']}} (ASN{{network['asn']}})</option>
                        {% endif %}
                    {% endfor %}
                </select>
                <script>
                    $(function() {
                        $('#network_elem').change(function() {
                            document.getElementById("network_elem_hidden").value = trimChar($(this).val().join(','),',');
                            console.log($(this).val());
                        }).multipleSelect({
                            width: '100%',
                            placeholder: 'Networks'
                        });
                    });
                </script>
              </div>
            </div>
            <div class="w-col w-col-6">
              <label for="name-2" class="field-label-29">Shodan API key</label>
              <input type="text" class="text-field-20 w-input" maxlength="256" name="api_key" data-name="Name 2" placeholder="" id="name-2">
              <label for="name-3" class="field-label-29">or select from saved:</label>
              <select id="field-3" name="api_id" data-name="Field 3" class="select-field-20 w-select">
                <option value="">...</option>
                  {% for team in db.select_user_teams(session['id']) %}
                      {% for config in db.select_configs(team_id=team['id'], name='shodan') %}
                          <option value="{{config['id']}}">{{escape(team['name'])}} - {{escape(config['name'])}}</option>
                      {% endfor %}
                  {% endfor %}
                {% for config in db.select_configs(user_id=session['id'], name='shodan') %}
                    <option value="{{config['id']}}">(private) {{escape(config['name'])}}</option>
                {% endfor %}
              </select>
              <label class="w-checkbox">
                <input type="checkbox" id="need_network" name="need_network" data-name="need_networks" class="w-checkbox-input" value="1">
                <span for="need_networks" class="w-form-label">Add ASN info</span>
              </label>
              <input type="submit" value="Submit" data-wait="Please wait..." class="submit-button-39 w-button">
            </div>
          </div>
        </form>
        {% if errors is defined and errors != [] %}
            {% for error in errors %}
              <div class="error-message w-form-fail" style="display: block">
                  <div>{{error}}</div>
              </div>
            {% endfor %}
        {% endif %}
      </div>
    </div>
  </div>
  {% include 'footer.html' %}
</body>
</html>