<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Jul 06 2020 16:48:25 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5ee155d95c6bb9f24cd8bf9c" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-col w-col-11">
      <div class="section-6 w-clearfix">
        <h1 class="heading-3">{{escape(current_host['ip'])}}</h1>
        <div data-duration-in="300" data-duration-out="100" class="tabs-4 w-tabs">
          <div class="tabs-menu-2 w-tab-menu">
            <a data-w-tab="services" class="tab-link-services w-inline-block w-tab-link w--current">
              <div>Services</div>
            </a>
            <a data-w-tab="hostnames" class="tab-link-hostnames w-inline-block w-tab-link">
              <div>Hostnames</div>
            </a>
            <a data-w-tab="issues" class="tab-link-issues w-inline-block w-tab-link">
              <div>Issues</div>
            </a>
            <!-- disabled TODO: add later -->
            <!--
            <a data-w-tab="scanners" class="tab-link-scanners w-inline-block w-tab-link">
              <div>Scanners</div>
            </a>
            -->
            <a data-w-tab="credentials" class="tab-link-tab-20 w-inline-block w-tab-link w--current">
              <div>Credentials</div>
            </a>
          </div>
          <div class="tabs-content w-tab-content">
            <div data-w-tab="services" class="w-tab-pane">
              <div class="columns-10 w-row">
                <div class="column-36 w-col w-col-1">
                  <div class="text-block-8">port</div>
                </div>
                <div class="column-37 w-col w-col-2">
                  <div class="text-block-8">service</div>
                </div>
                <div class="column-38 w-col w-col-5">
                  <div class="text-block-8">info</div>
                </div>
                <div class="column-39 w-col w-col-2">
                  <div class="text-block-8">threats</div>
                </div>
                <div class="column-40 w-col w-col-2"></div>
              </div>


              <!-- -->
              {% set ports = db.select_host_ports(current_host['id']) %}
              {% for current_port in ports %}
              {% if loop.index % 2  == 0 %}
                  <div class="columns-15 w-row">
              {% else %}
                  <div class="columns-16 w-row">
              {% endif %}
                <div class="column-43 w-clearfix w-col w-col-1">
                  <div class="text-block-10" id="port_num_{{loop.index}}" style="word-break: break-all; white-space:pre-wrap;">{{current_port['port']}}/{% if current_port['is_tcp'] %}tcp{% else %}udp{% endif %}</div>
                </div>
                <div class="column-42 w-clearfix w-col w-col-2">
                  <div class="text-block-10" id="port_service_{{loop.index}}" style="word-break: break-all; white-space:pre-wrap;">{{escape(current_port['service'])}}</div>
                </div>
                <div class="column-41 w-clearfix w-col w-col-5">
                  <div class="text-block-10" id="port_description_{{loop.index}}" style="word-break: break-all; white-space:pre-wrap;">{{escape(current_port['description'])}}</div>
                </div>
                <div class="column-44 w-col w-col-2">
                  <div class="div-block-5 w-clearfix">
                    {% set threats = db.select_port_issues_stats(current_port['id']) %}
                    {% if threats['critical'] %}
                    <img src="/static/images/exclamation_mark_PNG64.png" srcset="/static/images/exclamation_mark_PNG64-p-500.png 500w, /static/images/exclamation_mark_PNG64.png 600w" sizes="30px" alt="" class="image-9">
                    {% endif %}
                    {% if threats['high'] %}
                    <img src="/static/images/kindpng_314237.png" srcset="/static/images/kindpng_314237-p-500.png 500w, /static/images/kindpng_314237.png 739w" sizes="30px" alt="" class="image-10">
                    {% endif %}
                    {% if threats['medium'] %}
                    <img src="/static/images/5f60c69556aed40887871443_output-onlinepngtools.png" loading="lazy" alt="" class="image-18">
                    {% endif %}
                    {% if threats['low'] %}
                    <img src="/static/images/kindpng_314604.png" srcset="/static/images/kindpng_314604-p-500.png 500w, /static/images/kindpng_314604.png 640w" sizes="30px" alt="" class="image-11">
                    {% endif %}
                    {% if threats['info'] %}
                    <img src="/static/images/pngwing.com.png" alt="" class="image-12">
                    {% endif %}
                  </div>
                </div>
                <div class="column-45 w-clearfix w-col w-col-2">
                  <script>
                      function copy_data_{{loop.index}}(){
                        document.getElementById("port").value = document.getElementById("port_num_{{loop.index}}").textContent;
                        document.getElementById("port_descr").value = document.getElementById("port_description_{{loop.index}}").textContent;
                        document.getElementById("service_text").value = "";
                        var service_field = document.getElementById("port_service");
                        if (!service_field){
                            select = document.getElementById('service');
                            var service_field = document.createElement('option');
                            service_field.setAttribute("id", "port_service");
                            select.prepend(service_field);
                        }
                        service_field.value = document.getElementById("port_service_{{loop.index}}").textContent;
                        service_field.textContent = document.getElementById("port_service_{{loop.index}}").textContent;
                        service_field.selected = 'selected';
                      }
                  </script>
                  <button class="button-17 w-button" onclick="copy_data_{{loop.index}}()">Update</button>
                  <form method="post" action="/project/{{current_project['id']}}/host/{{current_host['id']}}/" onsubmit="return delete_prompt(this,'Are you sure to delete port {{escape(current_port['port'])}}?')">
                      <input type="hidden" name="delete_port" value="1"/>
                      <input type="hidden" name="port_id" value="{{current_port['id']}}"/>
                      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                      <button type="submit" class="button-16 w-button">Delete</button>
                  </form>
                </div>
              </div>

              {% endfor %}


              <div class="w-form">
                <form id="email-form" name="email-form" data-name="Email Form" method="post" action="/project/{{current_project['id']}}/host/{{current_host['id']}}/">
                  <input type="hidden" name="add_port" value="1"/>
                  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                  <div class="w-row">
                    <div class="column-56 w-col w-col-1">
                      <input type="text" class="w-input" maxlength="256" name="port" data-name="port" placeholder="80/tcp" id="port" required="">
                    </div>
                    <div class="column-57 w-col w-col-2">
                      <select id="service" name="service" data-name="service" required="" class="select-field-2 w-select" >
                        <!-- <option value="???" id="port_service">???</option> -->
                        <option value="http">HTTP</option>
                        <option value="https">HTTPS</option>
                        <option value="dns">DNS</option>
                        <option value="ftp">FTP</option>
                        <option value="telnet">Telnet</option>
                        <option value="other">Other</option>
                      </select>
                      <label for="name">or</label>
                      <input type="text" class="w-input" maxlength="256" name="service_text" data-name="Field 6" placeholder="Other protocol" id="service_text">
                    </div>
                    <div class="column-58 w-col w-col-5">
                      <textarea placeholder="information about service" maxlength="5000" id="port_descr" name="description" class="textarea-3 w-input"></textarea>
                    </div>
                    <div class="column-59 w-clearfix w-col w-col-2">
                      <input type="submit" value="Submit" data-wait="Please wait..." class="submit-button-7 w-button">
                    </div>
                    <div class="column-60 w-col w-col-2"></div>
                  </div>
                </form>
                {% if add_port_errors is defined and add_port_errors != [] %}
                    {% for error in add_port_errors %}
                      <div class="error-message w-form-fail" style="display: block">
                          <div>{{error}}</div>
                      </div>
                    {% endfor %}
                {% endif %}
              </div>
            </div>
            <div data-w-tab="hostnames" class="tab-pane-tab-2-2 w-tab-pane">
              <div class="columns-12 w-row">
                <div class="column-62 w-col w-col-4">
                  <div class="text-block-8">hostname</div>
                </div>
                <div class="column-63 w-col w-col-5">
                  <div class="text-block-8">comment</div>
                </div>
                <div class="column-69 w-col w-col-3"></div>
              </div>

              <!-- -->
              {% set hostnames = db.select_ip_hostnames(current_host['id']) %}
              {% for hostname in hostnames %}
              {% if loop.index % 2  == 0 %}
                  <div class="columns-13 w-row">
              {% else %}
                  <div class="columns-14 w-row">
              {% endif %}
                <div class="column-65 w-clearfix w-col w-col-4">
                  <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;" id="hostname_{{loop.index}}">{{escape(hostname['hostname'])}}</div>
                </div>
                <div class="column-66 w-clearfix w-col w-col-5">
                  <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;" id="hostname_comment_{{loop.index}}">{{escape(hostname['description'])}}</div>
                </div>
                <script>
                  //TODO: optimise

                    function copy_hostname_{{loop.index}}(){
                      document.getElementById("hostname_field").value = document.getElementById("hostname_{{loop.index}}").textContent;
                      document.getElementById("hostname_comment").value = document.getElementById("hostname_comment_{{loop.index}}").textContent;
                      document.getElementById('add_hostname_form').scrollIntoView();
                    }
                </script>
                <div class="column-70 w-col w-col-3">
                  <button class="button-45 w-button" onclick="copy_hostname_{{loop.index}}();">Edit</button>
                  <form method="post" action="/project/{{current_project['id']}}/host/{{current_host['id']}}/" onsubmit="return delete_prompt(this,'Are you sure to delete hostname {{escape(hostname['hostname'])}}?')">
                      <input type="hidden" name="delete_hostname" value="1"/>
                      <input type="hidden" name="hostname_id" value="{{hostname['id']}}">
                      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                      <button type="submit" href="#" class="button-46 w-button">Delete</button>
                  </form>
                </div>
              </div>

              {% endfor %}
              <!-- -->

              <div class="w-form">
                <form name="email-form-3" id="add_hostname_form" data-name="Email Form 3" method="post" action="/project/{{current_project['id']}}/host/{{current_host['id']}}/">
                  <input type="hidden" name="add_hostname" value="1"/>
                  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                  <div class="columns-18 w-row">
                    <div class="w-col w-col-4">
                      <input type="text" class="w-input" maxlength="256" name="hostname" data-name="hostname" placeholder="hostname" id="hostname_field" required="">
                    </div>
                    <div class="w-col w-col-4">
                      <input type="text" class="w-input" maxlength="256" name="comment" data-name="comment" placeholder="comment" id="hostname_comment">
                    </div>
                    <div class="w-col w-col-4">
                      <input type="submit" value="Submit" data-wait="Please wait..." class="submit-button-10 w-button">
                    </div>
                  </div>
                </form>
                {% if add_hostname_errors is defined and add_hostname_errors != [] %}
                    {% for error in add_hostname_errors %}
                      <div class="error-message w-form-fail" style="display: block">
                          <div>{{error}}</div>
                      </div>
                    {% endfor %}
                {% endif %}

                {% if delete_hostname_errors is defined and delete_hostname_errors != [] %}
                    {% for error in delete_hostname_errors %}
                      <div class="error-message w-form-fail" style="display: block">
                          <div>{{error}}</div>
                      </div>
                    {% endfor %}
                {% endif %}
              </div>
            </div>
            <div data-w-tab="issues" class="tab-pane-tab-3 w-tab-pane">
              <div class="columns-19 w-row">
                <div class="column-74 w-col w-col-1">
                  <div class="text-block-8">port</div>
                </div>
                <div class="column-75 w-col w-col-2">
                  <div class="text-block-8">name</div>
                </div>
                <div class="column-76 w-col w-col-4">
                  <div class="text-block-8">description</div>
                </div>
                <div class="column-77 w-col w-col-1">
                  <div class="text-block-8">CVSS</div>
                </div>
                <div class="column-100 w-col w-col-2">
                  <div class="text-block-8">status</div>
                </div>
                <div class="column-99 w-col w-col-2"></div>
              </div>


              {% set issues = db.select_host_issues(current_host['id']) %}
              {% for issue in issues %}
                  {% if issue['cvss']==0 %}
                      <div class="columns-23 w-row">
                  {% elif issue['cvss']<=3.9 %}
                      <div class="columns-22 w-row">
                  {% elif issue['cvss']<=6.9 %}
                      <div class="columns-68 w-row">
                  {% elif issue['cvss'] <= 8.9 %}
                      <div class="columns-21 w-row">
                  {% else %}
                      <div class="columns-20 w-row">
                  {% endif %}

                  <div class="column-79 w-clearfix w-col w-col-1">
                    {% for port_id in json_unpack(issue['services']) %}
                        {% set current_port = db.select_port(port_id)[0] %}
                        {% if current_port['host_id']==current_host['id'] %}
                            {% if current_port['port'] == 0 %}
                            <div class="text-block-10">All</div>
                            {% else %}
                            <div class="text-block-10">{{current_port['port']}}/{{'tcp' if current_port['is_tcp'] else 'udp'}}</div>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                  </div>
                  <div class="column-80 w-clearfix w-col w-col-2">
                    <div class="text-block-10">{{escape(issue['name'])}}</div>
                  </div>
                  <div class="column-81 w-clearfix w-col w-col-4">
                    <div class="text-block-10" style="white-space:pre-wrap;">{{escape(issue['description'])}}</div>
                  </div>
                  <div class="column-82 w-clearfix w-col w-col-1">
                    <div class="text-block-10">{{escape(issue['cvss'])}}</div>
                  </div>
                  <div class="column-83 w-col w-col-2">
                    <div class="text-block-10">{{escape(issue['status'])}}</div>
                  </div>
                  <div class="column-101 w-clearfix w-col w-col-2">
                    <a href="/project/{{current_project['id']}}/issue/{{issue['id']}}/" class="button-17 w-button">Update</a>
                    <form method="post" action="/project/{{current_project['id']}}/host/{{current_host['id']}}/" onsubmit="return delete_prompt(this,'Are you sure to delete issue {{escape(issue['name'])}}?')">
                        <input type="hidden" name="delete_host_issue" value="1"/>
                        <input type="hidden" name="issue_id" value="{{issue['id']}}">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <button type="submit" href="#" class="button-16 w-button">Delete</button>
                    </form>
                  </div>
                </div>

              {% endfor %}
              <div class="w-form">
                <form id="email-form-5" name="email-form-5" data-name="Email Form 5" class="w-clearfix" action="/project/{{current_project['id']}}/new_issue" method="get">
                  <button type="submit" class="button-18 w-button">Add new vulnerability</button>
                  <select id="field-5" name="service" class="select-field-9 w-select">
                    <option value="">-</option>
                    {% for current_port in db.select_host_ports(current_host['id'], full=True) %}
                        <option value="{{current_port['id']}}">{% if current_port['port'] == 0 %}Whole host {% else %}{{current_port['port']}}/{% if current_port['is_tcp'] %}tcp{% else %}udp{% endif %}{% endif %}</option>
                    {% endfor %}
                  </select>
                  <select id="field-5" name="hostname" class="select-field-9 w-select">
                    <option value="0">{{current_host['ip']}}</option>
                    {% for hostname in hostnames %}
                    <option value="{{hostname['id']}}">{{escape(hostname['hostname'])}}</option>
                    {% endfor %}
                  </select>
                </form>
              </div>
            </div>
            <!--
            <div data-w-tab="scanners" class="w-tab-pane w--tab-active">
              <div class="w-row">
                <div class="column-105 w-col w-col-2">
                  <div class="text-block-8">tool</div>
                </div>
                <div class="column-106 w-col w-col-2">
                  <div class="text-block-8">ports</div>
                </div>
                <div class="column-107 w-col w-col-2">
                  <div class="text-block-8">destination</div>
                </div>
                <div class="column-108 w-col w-col-4">
                  <div class="text-block-8">resume</div>
                </div>
                <div class="column-109 w-col w-col-2"></div>
              </div>
              <div class="columns-24 w-row">
                <div class="column-110 w-clearfix w-col w-col-2">
                  <div class="text-block-10">nmap</div>
                </div>
                <div class="column-111 w-clearfix w-col w-col-2">
                  <div class="text-block-10">1-65535 tcp</div>
                </div>
                <div class="column-112 w-clearfix w-col w-col-2">
                  <div class="text-block-10"></div>
                </div>
                <div class="column-113 w-clearfix w-col w-col-4">
                  <div class="text-block-10">Starting Nmap 7.80 ( https://nmap.org ) <br>Not shown: 65526 closed ports<br>PORT     STATE SERVICE<br>111/tcp  open  rpcbind<br>5355/tcp open  llmnr</div>
                </div>
                <div class="column-114 w-col w-col-2">
                  <a href="#" class="button-19 w-button">Download</a>
                  <a href="../../project-pages/tools/toolslist.html" class="button-20 w-button">Edit</a>
                </div>
              </div>
              <div class="columns-25 w-row">
                <div class="column-115 w-clearfix w-col w-col-2">
                  <div class="text-block-10">nmap</div>
                </div>
                <div class="column-116 w-clearfix w-col w-col-2">
                  <div class="text-block-10">top-100 udp</div>
                </div>
                <div class="column-117 w-col w-col-2"></div>
                <div class="column-118 w-clearfix w-col w-col-4">
                  <div class="text-block-10">Starting Nmap 7.80 ( https://nmap.org ) <br>Not shown: 99 closed ports<br>PORT    STATE SERVICE<br>111/udp open  rpcbind</div>
                </div>
                <div class="column-119 w-col w-col-2">
                  <a href="#" class="button-19 w-button">Download</a>
                  <a href="../../project-pages/tools/toolslist.html" class="button-20 w-button">Edit</a>
                </div>
              </div>
              <div class="columns-26 w-row">
                <div class="column-120 w-clearfix w-col w-col-2">
                  <div class="text-block-10">dirbuster</div>
                </div>
                <div class="column-121 w-clearfix w-col w-col-2">
                  <div class="text-block-10">80/tcp</div>
                </div>
                <div class="column-122 w-clearfix w-col w-col-2">
                  <div class="text-block-10">/templates/</div>
                </div>
                <div class="column-123 w-clearfix w-col w-col-4">
                  <div class="text-block-10">2019/06/21 11:49:43 Starting gobuster<br><br>/categories (Status: 301)<br>/contact (Status: 301)<br>/posts (Status: 301)<br>/index (Status: 200)<br><br>2019/06/21 11:49:44 Finished</div>
                </div>
                <div class="column-124 w-col w-col-2"><a href="#" class="button-19 w-button">Download</a>
                  <a href="../../project-pages/tools/toolslist.html" class="button-20 w-button">Edit</a>
                </div>
              </div>
              <div class="w-form">
                <form id="email-form-4" name="email-form-4" data-name="Email Form 4">
                  <div class="columns-46 w-row">
                    <div class="w-col w-col-2">
                      <input type="text" class="w-input" maxlength="256" name="field-3" data-name="Field 3" placeholder="Example Text" id="field-3" required="">
                    </div>
                    <div class="w-col w-col-2">
                      <select id="field-4" name="field-4" class="w-select">
                        <option value="">Select one...</option>
                        <option value="top-100 udp">top-100 udp</option>
                        <option value="top-100 tcp">top-100 tcp</option>
                        <option value="top-1000 udp">top-1000 udp</option>
                        <option value="top-1000 udp">top-1000 tcp</option>
                        <option value="All tcp ports">All TCP ports</option>
                        <option value="All UDP ports">All UDP ports</option>
                        <option value="80/tcp">80/tcp</option>
                        <option value="53/udp">53/udp</option>
                        <option value="55555/tcp">55555/tcp</option>
                      </select>
                      <div class="text-block-35">or</div>
                      <input type="text" class="w-input" maxlength="256" name="80-tcp" data-name="80/tcp" placeholder="80/tcp" id="80-tcp">
                    </div>
                    <div class="w-col w-col-2">
                      <input type="text" class="w-input" maxlength="256" name="destination" data-name="destination" placeholder="/admin/" id="destination">
                    </div>
                    <div class="w-col w-col-4">
                      <input type="file" class="w-input" maxlength="256" name="File" data-name="File" placeholder="File input here" id="File">
                      <div class="text-block-35">or</div>
                      <textarea placeholder="Scanner output" maxlength="5000" id="scan-result" name="scan-result" data-name="scan result" class="w-input"></textarea>
                    </div>
                    <div class="w-col w-col-2">
                      <input type="submit" value="Submit" data-wait="Please wait..." class="submit-button-18 w-button">
                    </div>
                  </div>
                </form>
                <div class="w-form-done">
                  <div>Thank you! Your submission has been received!</div>
                </div>
                <div class="w-form-fail">
                  <div>Oops! Something went wrong while submitting the form.</div>
                </div>
              </div>
            </div> -->
            <div data-w-tab="credentials" class="w-tab-pane w--tab-active">
              <div class="w-row">
                <div class="column-257 w-col w-col-1">
                  <div class="text-block-8">port</div>
                </div>
                <div class="column-258 w-col w-col-2">
                  <div class="text-block-8">login</div>
                </div>
                <div class="column-259 w-col w-col-3">
                  <div class="text-block-8">hash</div>
                </div>
                <div class="column-260 w-col w-col-2">
                  <div class="text-block-8">cleartext</div>
                </div>
                <div class="column-261 w-col w-col-2">
                  <div class="text-block-8">comment</div>
                </div>
                <div class="column-262 w-col w-col-2"></div>
              </div>
              {% set ports = db.select_host_ports(current_host['id'], full=True) %}
              {% set credentials = db.select_creds_by_host(current_project['id'], current_host['id']) %}
              {% for current_creds in credentials %}

                  {% if loop.index % 2 == 0 %}
              <div class="columns-69 w-row">
                  {% else %}
              <div class="columns-70 w-row">
                  {% endif %}
                <div class="column-263 w-clearfix w-col w-col-1">
                  {% for current_port in json_unpack(current_creds['services']) %}
                      {% set port_ids = [] %}
                      {% for test_port in ports %}
                          {% if test_port['id'] == current_port %}
                              {% if port_ids.append(test_port) %}{% endif %}
                          {% endif %}
                      {% endfor %}
                      {% if port_ids %}
                          {% if port_ids[0]['port'] == 0 %}
                              <div class="text-block-10">Whole host</div>
                          {% else %}
                              <div class="text-block-10">{{port_ids[0]['port']}}/{% if port_ids[0]['is_tcp'] %}tcp{% else %}udp{% endif %}</div>
                          {% endif %}
                      {% endif %}
                  {% endfor %}
                </div>
                <div class="column-264 w-clearfix w-col w-col-2">
                  <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;">{{escape(current_creds['login'])}}</div>
                </div>
                <div class="column-265 w-clearfix w-col w-col-3">
                  <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;">{{escape(current_creds['hash'])}}</div>
                </div>
                <div class="column-266 w-col w-col-2">
                  <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;">{{escape(current_creds['cleartext'])}}</div>
                </div>
                <div class="column-267 w-clearfix w-col w-col-2">
                  <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;">{{escape(current_creds['description'])}}</div>
                </div>
                <div class="column-268 w-col w-col-2">

                  <a href="/project/{{current_project['id']}}/credentials/{{current_creds['id']}}/" class="button-54 w-button">Open</a>
                  <!--
                  <div class="form-block-16 w-form">
                      <form method="post" action="/project/{{current_project['id']}}/credentials/{{current_creds['id']}}/">
                        <button type="submit" name="action" value="delete" class="button-55 w-button">Delete</button>
                      </form>
                  </div>
                  -->
                </div>
              </div>

              {% endfor %}


              <script>
                  function submit_issue(){
                      var
                              login = document.getElementById('login_new_creds').value ,
                              hash = document.getElementById('hash_new_creds').value ,
                              cleartext = document.getElementById('cleartext_new_creds').value ,
                              comment = document.getElementById('comment_new_creds').value ;
                      var e = document.getElementById('port_new_creds');
                      var port_id = e.options[e.selectedIndex].value;
                      e = document.getElementById('hostname_new_creds');
                      var hostname_id = e.options[e.selectedIndex].value;

                      var send_data = {
                        "login": login,
                        "password_hash": hash,
                        "cleartext_password": cleartext,
                        "comment": comment,
                        "csrf_token": "{{csrf_token()}}"
                      };

                      if (hostname_id==="0"){
                        send_data['ip_port-0'] = port_id;
                      } else {
                        send_data['host_port-0'] = port_id + ':' + hostname_id;
                      }
                      $.ajax({
                        type: "POST",
                        url: "/project/{{current_project['id']}}/credentials/new_creds",
                        data: send_data,
                        headers: {
                          "Content-Type": "application/x-www-form-urlencoded"
                        }
                      });
                      window.location.reload(true);
                  }
              </script>

              <script>
                  function submit_poc(){
                      var
                              login = document.getElementById('login_new_creds').value ,
                              hash = document.getElementById('hash_new_creds').value ,
                              cleartext = document.getElementById('cleartext_new_creds').value ,
                              comment = document.getElementById('comment_new_creds').value ;
                      var e = document.getElementById('port_new_creds');
                      if (e.selectedIndex === -1){
                        alert('Need to set credentials port!');
                        return;
                      }
                      var port_id = e.options[e.selectedIndex].value;
                      e = document.getElementById('hostname_new_creds');
                      var hostname_id = e.options[e.selectedIndex].value;

                      var send_data = {
                        "login": login,
                        "password_hash": hash,
                        "cleartext_password": cleartext,
                        "comment": comment,
                        "csrf_token": "{{csrf_token()}}"
                      };

                      if (hostname_id==="0"){
                        send_data['ip_port-0'] = port_id;
                      } else {
                        send_data['host_port-0'] = port_id + ':' + hostname_id;
                      }
                      $.ajax({
                        type: "POST",
                        url: "/project/{{current_project['id']}}/credentials/new_creds",
                        data: send_data,
                        headers: {
                          "Content-Type": "application/x-www-form-urlencoded"
                        },
                        cache: false
                      });
                      window.location.reload(true);
                  }
              </script>

              <div class="w-form">
                <form id="new_creds" onsubmit="submit_poc(); return false;">
                  <div class="columns-71 w-row">
                    <div class="column-275 w-col w-col-1"></div>
                    <div class="w-col w-col-2">
                      <input type="text" class="w-input" maxlength="256" name="login" data-name="login" placeholder="login" id="login_new_creds">
                      <select id="port_new_creds" name="field-7" class="w-select">
                        {% for port in ports %}
                            {% if port['port']==0 and port['is_tcp']==True %}
                                <option value="{{port['id']}}">Whole host</option>
                            {% else %}
                                <option value="{{port['id']}}">{{port['port']}}/{% if port['is_tcp'] %}tcp{% else %}udp{% endif %}</option>
                            {% endif %}
                        {% endfor %}
                      </select>
                    </div>
                    <div class="w-col w-col-3">
                      <input type="text" class="w-input" maxlength="256" name="hash" data-name="hash" placeholder="hash" id="hash_new_creds">
                      <select id="hostname_new_creds" name="hostname" data-name="hostname" class="w-select">
                        <option value="0">{{current_host['ip']}}</option>
                        {% for hostname in hostnames %}
                            <option value="{{hostname['id']}}">{{escape(hostname['hostname'])}}</option>
                        {% endfor %}
                      </select>
                    </div>
                    <div class="w-col w-col-2">
                      <input type="text" class="w-input" maxlength="256" name="cleartext" data-name="cleartext" placeholder="cleartext" id="cleartext_new_creds">
                    </div>
                    <div class="w-col w-col-2">
                      <input type="text" class="w-input" maxlength="256" name="comment" data-name="comment" placeholder="comment" id="comment_new_creds">
                    </div>
                    <div class="w-col w-col-2">
                      <input type="submit" value="Submit" data-wait="Please wait..." class="submit-button-36 w-button">
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="form-block-6 w-form">
        <form id="email-form-2" name="email-form-2" data-name="Email Form 2" class="form-5" action="/project/{{current_project['id']}}/host/{{current_host['id']}}/" method="post" onsubmit="return delete_prompt(this,'Are you sure to edit or delete host?');">
          <input type="hidden" name="update_description" value="1"/>
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
          <div class="columns-47 w-row">
            <div class="w-col w-col-4">
              <label for="name">Host comment:</label>
              <textarea placeholder="Example Text" maxlength="5000" id="field-2" name="comment" class="textarea-4 w-input">{{escape(current_host['comment'])}}</textarea>
            </div>
            <div class="column-61 w-col w-col-3">
              <label for="email" class="field-label-14">Threats:</label>
              {% set current_threats=json_unpack(current_host['threats']) %}
              <label class="w-checkbox checkbox-field-4">
                <input type="checkbox" id="checkbox" name="threats-0" data-name="Checkbox" class="w-checkbox-input" value="high" {% if 'high' in current_threats %} checked {% endif %}>
                <span class="w-form-label">High</span>
              </label>
              <label class="w-checkbox checkbox-field-5">
              <input type="checkbox" id="checkbox-2" name="threats-1" data-name="Checkbox 2" class="w-checkbox-input" value="medium" {% if 'medium' in current_threats %} checked {% endif %}>
                <span class="w-form-label">Medium</span>
              </label>
              <label class="w-checkbox checkbox-field-6">
                <input type="checkbox" id="checkbox-3" name="threats-2" data-name="Checkbox 3" class="w-checkbox-input" value="low" {% if 'low' in current_threats %} checked {% endif %}>
                <span class="w-form-label">Low</span>
              </label>
              <label class="w-checkbox checkbox-field-7">
                <input type="checkbox" id="checkbox-4" name="threats-3" data-name="Checkbox 4" class="w-checkbox-input" value="info" {% if 'info' in current_threats %} checked {% endif %}>
                <span class="w-form-label">Information</span>
              </label>
              <label class="w-checkbox checkbox-field-8">
                <input type="checkbox" id="checkbox-5" name="threats-4" data-name="Checkbox 5" class="w-checkbox-input" value="check" {% if 'check' in current_threats %} checked {% endif %}>
                <span class="w-form-label">Need to check again</span>
              </label>
              <label class="w-checkbox checkbox-field-8">
                <input type="checkbox" id="checkbox-5" name="threats-5" data-name="Checkbox 5" class="w-checkbox-input" value="checked" {% if 'checked' in current_threats %} checked {% endif %}>
                <span class="w-form-label">Checked!</span>
              </label>
            </div>
            <div class="column-73 w-col w-col-5">
              <input type="submit" value="Update" data-wait="Please wait..." class="submit-button-9 w-button">
              <button type="submit" name="Submit" value="Delete" class="button-21 w-button">Delete</button>
            </div>
          </div>
        </form>
        {% if edit_description_errors is defined and edit_description_errors != [] %}
            {% for error in edit_description_errors %}
              <div class="error-message w-form-fail" style="display: block">
                  <div>{{error}}</div>
              </div>
            {% endfor %}
        {% endif %}
      </div>
    </div>
  </div>
{% include 'footer.html' %}
</body>
</html>