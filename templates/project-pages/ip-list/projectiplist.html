<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Jul 06 2020 16:48:25 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5ec80f8feb479848da6b3b71" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <style>
      .link-block-4:hover{
          color: black;
          border:2px solid;
      }
  </style>

  <div class="columns w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-col w-col-11">
      <div class="w-clearfix">
          {% set host_array = db.search_hostlist(project_id=current_project['id'],
                        network=request.args.get('network'), ip_hostname=request.args.get('ip_hostname'),
                        issue_name=request.args.get('issue_name'),
                        port=request.args.get('port'), service=request.args.get('service'),
                        comment=request.args.get('comment'), threats=request.args.getlist('threat[]') ) %}
          <h1 class="heading-3">Hosts: {{ len(host_array) }}</h1>
          <div class="form-block-13 w-form">
            <form id="email-form-3" name="email-form-3" data-name="Email Form 3" method="get" action="/project/{{current_project['id']}}/hosts/">
              <div class="columns-59 w-row">
                <div class="w-col w-col-2">
                    <input type="hidden" id="network_elem_hidden" name="network" value="{% if 'network' in request.args %}{{escape(request.args.get('network'))}}{% endif %}">
                    <select id="network_elem" multiple="multiple" class="form-control">
                        {% set networks = db.select_project_networks(current_project['id']) %}
                        {% for network in networks %}
                            <option value="{{network['id']}}" {% if 'network' in request.args and network['id'] in request.args['network'] %}selected {% endif %}>{{network['ip']}}/{{network['mask']}}</option>
                        {% endfor %}
                    </select>
                    <script>
                        $(function() {
                            $('#network_elem').change(function() {
                                document.getElementById("network_elem_hidden").value = trimChar($(this).val().join(','),',');
                                console.log($(this).val());
                            }).multipleSelect({
                                width: '100%',
                                placeholder: 'Networks'
                            });
                        });
                    </script>
                    <input type="hidden" id="port_elem_hidden" name="port" value="{% if 'port' in request.args and request.args['port'] %}{{escape(request.args['port'])}}{% endif %}">
                    <div style="margin-top: 28px">
                    <select id="port_elem" multiple="multiple" class="form-control">
                        {% set port_arr = [] %}
                        {% if 'port' in request.args and request.args['port'] %}
                            {% set port_arr = request.args['port'].split(',') %}
                        {% endif %}}
                        {% set ports = db.select_project_ports_unique(current_project['id']) %}
                        {% for port in ports %}
                            {% if port['is_tcp'] %}
                                {% set port_proto = 'tcp' %}
                            {% else %}
                                {% set port_proto = 'udp' %}
                            {% endif %}
                            {% set port_str = str(port['port']) + '/' + port_proto %}
                            <option value="{{port_str}}" {% if port_str in port_arr %} selected {% endif %}>{{port_str}}</option>
                        {% endfor %}
                    </select>
                    </div>
                    <script>
                        $(function() {
                            $('#port_elem').change(function() {
                                document.getElementById("port_elem_hidden").value = trimChar($(this).val().join(','),',');
                                console.log($(this).val());
                            }).multipleSelect({
                                width: '100%',
                                placeholder: 'Ports'
                            });
                        });
                    </script>
                </div>
                <div class="column-236 w-col w-col-3">
                  <div class="div-block-21">
                      <input type="text" class="text-field-23 w-input" maxlength="256" name="ip_hostname" data-name="Field 5" placeholder="ip / hostname" id="ip_hostname" {% if 'ip_hostname' in request.args %} value="{{escape(request.args['ip_hostname'])}}" {% endif %}>
                      <input type="text" class="text-field-25 w-input" maxlength="256" name="service" data-name="Field 8" placeholder="service1,service2" id="service_elem" {% if 'service' in request.args %} value="{{escape(request.args['service'])}}" {% endif %}>
                  </div>
                </div>
                <div class="column-234 w-col w-col-3">
                  <div class="div-block-20">
                      <input type="text" class="text-field-26 w-input" maxlength="256" name="issue_name" data-name="Issue Name" placeholder="Issue name" id="issue_name" {% if 'issue_name' in request.args %} value="{{escape(request.args['issue_name'])}}" {% endif %}>
                      <input type="text" class="text-field-24 w-input" maxlength="256" name="comment" data-name="Field 6" placeholder="host comment" id="comment_elem" {% if 'comment' in request.args %} value="{{escape(request.args['comment'])}}" {% endif %}>
                  </div>
                </div>
                <div class="column-235 w-col w-col-2">
                    {% set threats = request.args.getlist('threat[]') %}
                    <label class="w-checkbox checkbox-field-12">
                        <input type="checkbox" id="high_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="high" {% if 'high' in threats %} checked {% endif %}>
                        <span class="w-form-label">High</span>
                    </label>
                    <label class="w-checkbox checkbox-field-13">
                        <input type="checkbox" id="medium_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="medium" {% if 'medium' in threats %} checked {% endif %}>
                        <span class="w-form-label">Medium</span>
                    </label>
                    <label class="w-checkbox checkbox-field-14">
                        <input type="checkbox" id="low_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="low" {% if 'low' in threats %} checked {% endif %}>
                        <span class="w-form-label">Low</span>
                    </label>
                    <label class="w-checkbox checkbox-field-15">
                        <input type="checkbox" id="info_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="info" {% if 'info' in threats %} checked {% endif %}>
                        <span class="w-form-label">Info</span>
                    </label>
                    <label class="w-checkbox checkbox-field-16">
                        <input type="checkbox" id="check_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="check" {% if 'check' in threats %} checked {% endif %}>
                        <span class="w-form-label">Need to check</span>
                    </label>
                    <label class="w-checkbox checkbox-field-17">
                        <input type="checkbox" id="checked_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="checked" {% if 'checked' in threats %} checked {% endif %}>
                        <span class="w-form-label">Checked</span>
                    </label>
                </div>
                <div class="w-clearfix w-col w-col-2">
                    <input type="submit" value="Search" data-wait="Please wait..." class="submit-button-26 w-button">
                    <a href="new_host" class="button-48 w-button">Add</a>
                    <button type="button" class="button-49 w-button" onclick="view_results('../tools/exporter/');">Export result</button>
                </div>
              </div>
            </form>
          </div>
        </div>



        <script>
            $(document).ready(function() {
                $('#example').DataTable( {
                    "order": [[ 0, "asc" ]],
                    "iDisplayLength": 100,
                    "aoColumns": [
                      { "sType": "integer" },
                      { "sType": "string" },
                      { "sType": "string" },
                      { "sType": "string" },
                      { "sType": "string" }
                    ]
                } );
            } );
            $(document).on('click', '.custom-clickable-row', function(e){
                var url = $(this).data('href');

                window.location = url;
            });
        </script>
        <table id="example" class="display">
        <thead>
            <tr id="table_header">
                <th style="width: 16.66666667%; border-top-left-radius: 8px;"><h4>ip-address</h4></th>
                <th style="width: 25%;"><h4>hostnames</h4></th>
                <th style="width: 25%;"><h4>comment</h4></th>
                <th style="width: 16.66666667%;"><h4>check status</h4></th>
                <th style="width: 16.66666667%; border-top-right-radius: 8px;"><h4>threats</h4></th>
            </tr>
        </thead>
        <tbody>
            {% for host in host_array %}
            {% if ':' not in host['ip'] %} {% set ip_array = host['ip'].split('.') %} {% endif %}
            <tr class="custom-clickable-row" data-href="/project/{{current_project['id']}}/host/{{host['id']}}/">
                <td data-order="{% if ':' not in host['ip'] %}{{escape('{:0>3}{:0>3}{:0>3}{:0>3}'.format(ip_array[0],ip_array[1],ip_array[2],ip_array[3]))}}{% endif %}">
                    <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;" >{{escape(host['ip'])}}</div>
                </td>
                <td>
                    <div class="text-block-10" style="word-break: break-all;">
                        {% for hostname in db.select_ip_hostnames(host['id']) %}
                            {{escape(hostname['hostname'])}}</br>
                        {% endfor %}
                    </div>
                </td>
                <td>
                    <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;">{{escape(host['comment'])}}</div>
                    {%  if 'mac' in host['os'].lower() %}<img src="/static/images/macos.png" loading="lazy" width="40" alt="" class="image-19">{%  elif 'win' in host['os'].lower() %}<img src="/static/images/windows.png" loading="lazy" width="40" alt="" class="image-19">{%  elif 'lin' in host['os'].lower() %}<img src="/static/images/linux.png" loading="lazy" width="40" alt="" class="image-19">{%  endif %}
                </td>
                <td></td>
                <td>
                    {% set threats = json_unpack(host['threats']) %}
                    {% if 'high' in threats %}
                    <img src="/static/images/exclamation_mark_PNG64.png" srcset="/static/images/exclamation_mark_PNG64-p-500.png 500w, /static/images/exclamation_mark_PNG64.png 600w" sizes="30px" alt="" class="image-9">
                    {% endif %}
                    {% if 'medium' in threats %}
                    <img src="/static/static/images/kindpng_314237.png" srcset="/static/images/kindpng_314237-p-500.png 500w, /static/images/kindpng_314237.png 739w" sizes="30px" alt="" class="image-10">
                    {% endif %}
                    {% if 'low' in threats %}
                    <img src="/static/images/kindpng_314604.png" srcset="/static/images/kindpng_314604-p-500.png 500w, /static/images/kindpng_314604.png 640w" sizes="30px" alt="" class="image-11">
                    {% endif %}
                    {% if 'info' in threats %}
                    <img src="/static/images/pngwing.com.png" alt="" class="image-12">
                    {% endif %}
                    {% if 'check' in threats %}
                    <img src="/static/images/d6368d8155eb832733a200df87f48e92-purple-circle-question-mark-icon-by-vexels.png" srcset="/static/images/d6368d8155eb832733a200df87f48e92-purple-circle-question-mark-icon-by-vexels-p-500.png 500w, /static/images/d6368d8155eb832733a200df87f48e92-purple-circle-question-mark-icon-by-vexels.png 512w" sizes="(max-width: 767px) 32px, (max-width: 991px) 4vw, 30px" alt="" class="image-13">
                    {% endif %}
                    {% if 'checked' in threats %}
                    <img src="/static/images/red-flag.png" loading="lazy" alt="" class="image-17">
                    {% endif %}
                </td>
            </tr>
            {% endfor %}

        </tbody>
        </table>

        <style>
            th{
                padding:0px;
                margin-top: 0px;
                margin-bottom: 0px;
                height: 30px;
            }
            h4{
                margin-top: 0px; margin-bottom: 0px; text-align: left; padding-left: 10px
            }
            table.dataTable thead th, table.dataTable thead td{
                padding: 0px 0px;
                height: 30px;
                background-color: #c0f7ff;
            }
            table.dataTable.stripe tbody tr.odd, table.dataTable.display tbody tr.odd{
                background-color: #fffdc2;
            }
            table.dataTable.stripe tbody tr.odd, table.dataTable.display tbody tr.even{
                background-color: #c3ffcd;
            }
            .custom-clickable-row {
                cursor: pointer;
            }
            .dataTable tr:hover td {
                background-color: lightgrey;
            }
            .dataTable tr:hover tr > .sorting_1 {
                background-color: lightgrey;
            }
            table.dataTable.display tbody tr.odd > .sorting_1, table.dataTable.order-column.stripe tbody tr.odd > .sorting_1{
                background-color: transparent;
            }
            table.dataTable.display tbody tr.even > .sorting_1, table.dataTable.order-column.stripe tbody tr.even > .sorting_1{
                background-color: transparent;
            }
            table.dataTable.display tbody tr.odd:hover > .sorting_1, table.dataTable.order-column.stripe tbody tr.odd:hover > .sorting_1{
                background-color: lightgrey;
            }
            table.dataTable.display tbody tr.even:hover > .sorting_1, table.dataTable.order-column.stripe tbody tr.even:hover > .sorting_1{
                background-color: lightgrey;
            }
            table.dataTable tbody th, table.dataTable tbody td {
                padding: 0px 0px;
                padding-top: 5px;
                padding-bottom: 5px;
            }
        </style>

    </div>
  </div>
{% include 'footer.html' %}
</body>
</html>