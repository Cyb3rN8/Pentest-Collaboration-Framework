<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Jul 06 2020 16:48:25 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5ec80f8feb479848da6b3b71" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <style>
      .link-block-4:hover{
          color: black;
          border:2px solid;
      }
  </style>

  <div class="columns w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-col w-col-11">
      <div class="w-clearfix">
          {% set host_array = db.search_hostlist(project_id=current_project['id'],
                        network=request.args.get('network'), ip_hostname=request.args.get('ip_hostname'),
                        issue_name=request.args.get('issue_name'),
                        port=request.args.get('port'), service=request.args.get('service'),
                        comment=request.args.get('comment'), threats=request.args.getlist('threat[]') ) %}
          <h1 class="heading-3">Hosts: {{ len(host_array) }}</h1>
          <div class="form-block-13 w-form">
            <form id="email-form-3" name="email-form-3" data-name="Email Form 3" method="get" action="/project/{{current_project['id']}}/hosts/">
              <div class="columns-59 w-row">
                <div class="w-col w-col-2">
                    <select id="network_elem" name="network" class="select-field-11 w-select">
                        {% if 'network' in request.args and is_valid_uuid(request.args['network']) %}
                        {% set network = db.select_network(request.args.get('network'))[0] %}
                        <option value="{{network['id']}}">{{network['ip']}}/{{network['mask']}}</option>
                        {% endif %}
                        <option value="">All networks</option>
                        {% set networks = db.select_project_networks(current_project['id']) %}
                        {% for network in networks %}
                            <option value="{{network['id']}}">{{network['ip']}}/{{network['mask']}}</option>
                        {% endfor %}
                    </select>
                    <input type="hidden" id="port_elem_hidden" name="port" value="{% if 'port' in request.args and request.args['port'] %}{{escape(request.args['port'])}}{% endif %}">
                    <select id="port_elem" multiple="multiple" class="form-control">
                        {% set port_arr = [] %}
                        {% if 'port' in request.args and request.args['port'] %}
                            {% set port_arr = request.args['port'].split(',') %}
                        {% endif %}}
                        {% set ports = db.select_project_ports_unique(current_project['id']) %}
                        {% for port in ports %}
                            {% if port['is_tcp'] %}
                                {% set port_proto = 'tcp' %}
                            {% else %}
                                % set port_proto = 'udp' %}
                            {% endif %}
                            {% set port_str = str(port['port']) + '/' + port_proto %}
                            <option value="{{port_str}}" {% if port_str in port_arr %} selected {% endif %}>{{port_str}}</option>
                        {% endfor %}
                    </select>
                    <script>
                        $(function() {
                            $('#port_elem').change(function() {
                                document.getElementById("port_elem_hidden").value = trimChar($(this).val().join(','),',');
                                console.log($(this).val());
                            }).multipleSelect({
                                width: '100%'
                            });
                        });
                    </script>
                </div>
                <div class="column-236 w-col w-col-3">
                  <div class="div-block-21">
                      <input type="text" class="text-field-23 w-input" maxlength="256" name="ip_hostname" data-name="Field 5" placeholder="ip / hostname" id="ip_hostname" {% if 'ip_hostname' in request.args %} value="{{escape(request.args['ip_hostname'])}}" {% endif %}>
                      <input type="text" class="text-field-25 w-input" maxlength="256" name="service" data-name="Field 8" placeholder="service1,service2" id="service_elem" {% if 'service' in request.args %} value="{{escape(request.args['service'])}}" {% endif %}>
                  </div>
                </div>
                <div class="column-234 w-col w-col-3">
                  <div class="div-block-20">
                      <input type="text" class="text-field-26 w-input" maxlength="256" name="issue_name" data-name="Issue Name" placeholder="Issue name" id="issue_name" {% if 'issue_name' in request.args %} value="{{escape(request.args['issue_name'])}}" {% endif %}>
                      <input type="text" class="text-field-24 w-input" maxlength="256" name="comment" data-name="Field 6" placeholder="host comment" id="comment_elem" {% if 'comment' in request.args %} value="{{escape(request.args['comment'])}}" {% endif %}>
                  </div>
                </div>
                <div class="column-235 w-col w-col-2">
                    {% set threats = request.args.getlist('threat[]') %}
                    <label class="w-checkbox checkbox-field-12">
                        <input type="checkbox" id="high_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="high" {% if 'high' in threats %} checked {% endif %}>
                        <span class="w-form-label">High</span>
                    </label>
                    <label class="w-checkbox checkbox-field-13">
                        <input type="checkbox" id="medium_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="medium" {% if 'medium' in threats %} checked {% endif %}>
                        <span class="w-form-label">Medium</span>
                    </label>
                    <label class="w-checkbox checkbox-field-14">
                        <input type="checkbox" id="low_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="low" {% if 'low' in threats %} checked {% endif %}>
                        <span class="w-form-label">Low</span>
                    </label>
                    <label class="w-checkbox checkbox-field-15">
                        <input type="checkbox" id="info_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="info" {% if 'info' in threats %} checked {% endif %}>
                        <span class="w-form-label">Info</span>
                    </label>
                    <label class="w-checkbox checkbox-field-16">
                        <input type="checkbox" id="check_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="check" {% if 'check' in threats %} checked {% endif %}>
                        <span class="w-form-label">Need to check</span>
                    </label>
                    <label class="w-checkbox checkbox-field-17">
                        <input type="checkbox" id="checked_elem" name="threat[]" data-name="Checkbox 3" class="w-checkbox-input" value="checked" {% if 'checked' in threats %} checked {% endif %}>
                        <span class="w-form-label">Checked</span>
                    </label>
                </div>
                <div class="w-clearfix w-col w-col-2">
                    <input type="submit" value="Search" data-wait="Please wait..." class="submit-button-26 w-button">
                    <a href="new_host" class="button-48 w-button">Add</a>
                    <button type="button" class="button-49 w-button" onclick="view_results('../tools/exporter/');">Export result</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      <div class="section">
        <div class="columns-2 w-row">
          <div class="column-2 w-col w-col-2">
            <div class="text-block-8">ip-address</div>
          </div>
          <div class="column-3 w-col w-col-3">
            <div class="text-block-8">hostnames</div>
          </div>
          <div class="column-4 w-col w-col-3">
            <div class="text-block-8">comment</div>
          </div>
          <div class="column-5 w-col w-col-2">
            <div class="text-block-8">check status</div>
          </div>
          <div class="column-6 w-col w-col-2">
            <div class="text-block-8">threats</div>
          </div>
        </div>
      </div>
      <div class="section-3">
        <!-- -->
        {% for host in host_array %}
            <a class="link-block-4 w-inline-block" href="/project/{{current_project['id']}}/host/{{host['id']}}/">
            {% if loop.index % 2  == 0 %}
                <div class="column1 w-row">
            {% else %}
                <div class="column2 w-row">
            {% endif %}
                <div class="column-7 w-col w-col-2">
                  <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;">{{escape(host['ip'])}}</div>
                </div>
                <div class="column-8 w-clearfix w-col w-col-3">
                  <div class="text-block-10" style="word-break: break-all;">
                  {% for hostname in db.select_ip_hostnames(host['id']) %}
                    {{escape(hostname['hostname'])}}</br>
                  {% endfor %}
                  </div>
                </div>
                <div class="column-9 w-clearfix w-col w-col-3">
                  <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;">{{escape(host['comment'])}}</div>
                </div>

                <div class="column-10 w-col w-col-2">
                  <!--
                  <div class="scanners">
                    <div class="text-block-16">Scanners</div>
                    <ul role="list" class="list-5">
                      <li>Nessus</li>
                    </ul>
                  </div>
                  <div class="ports">
                    <div class="text-block-15">Ports (nmap)</div>
                    <ul role="list" class="list-6">
                      <li>All UDP</li>
                      <li>All TCP</li>
                    </ul>
                  </div>
                  -->
                </div>

                <div class="column-11 w-col w-col-2">
                    {% set threats = json_unpack(host['threats']) %}
                    {% if 'high' in threats %}
                    <img src="/static/images/exclamation_mark_PNG64.png" srcset="/static/images/exclamation_mark_PNG64-p-500.png 500w, /static/images/exclamation_mark_PNG64.png 600w" sizes="30px" alt="" class="image-9">
                    {% endif %}
                    {% if 'medium' in threats %}
                    <img src="/static/static/images/kindpng_314237.png" srcset="/static/images/kindpng_314237-p-500.png 500w, /static/images/kindpng_314237.png 739w" sizes="30px" alt="" class="image-10">
                    {% endif %}
                    {% if 'low' in threats %}
                    <img src="/static/images/kindpng_314604.png" srcset="/static/images/kindpng_314604-p-500.png 500w, /static/images/kindpng_314604.png 640w" sizes="30px" alt="" class="image-11">
                    {% endif %}
                    {% if 'info' in threats %}
                    <img src="/static/images/pngwing.com.png" alt="" class="image-12">
                    {% endif %}
                    {% if 'check' in threats %}
                    <img src="/static/images/d6368d8155eb832733a200df87f48e92-purple-circle-question-mark-icon-by-vexels.png" srcset="/static/images/d6368d8155eb832733a200df87f48e92-purple-circle-question-mark-icon-by-vexels-p-500.png 500w, /static/images/d6368d8155eb832733a200df87f48e92-purple-circle-question-mark-icon-by-vexels.png 512w" sizes="(max-width: 767px) 32px, (max-width: 991px) 4vw, 30px" alt="" class="image-13">
                    {% endif %}
                    {% if 'checked' in threats %}
                    <img src="/static/images/red-flag.png" loading="lazy" alt="" class="image-17">
                    {% endif %}
                </div>
              </div>
              </a>

              {% endfor %}



        <!-- -->

      </div>
    </div>
  </div>
{% include 'footer.html' %}
</body>
</html>