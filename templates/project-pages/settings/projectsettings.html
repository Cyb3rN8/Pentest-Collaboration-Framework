<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Jul 06 2020 16:48:25 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5ec54206bd3cac2005ce0727" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-clearfix w-col w-col-11">
      <h1 class="heading-3">Project settings</h1>
      <div class="w-form">
        <form id="email-form" name="email-form" data-name="Email Form" class="form w-clearfix" method="post" action="/project/{{current_project['id']}}/settings/" onsubmit="return delete_prompt(this,'Are you sure to update or archive project?')">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
          <div class="w-row">
            <div class="w-clearfix w-col w-col-6">
              <label for="Name" class="field-label">Name:</label>
              <input type="text" class="text-field w-input" maxlength="256" name="name" data-name="Name" placeholder="Project name" id="Name" required="" value="{{escape(current_project['name'])}}">
              <label for="Description" class="field-label-3">Description:</label>
              <textarea placeholder="Project description" maxlength="5000" id="Description" name="description" data-name="Description" class="textarea w-input">{{escape(current_project['description'])}}</textarea>
              <label class="field-label-5">Project type:</label>
              <select id="field" name="type" required="" data-name="Field" class="select-field-6 w-select">
                <option value="{{escape(current_project['type'])}}">{{escape(current_project['type'])}}</option>
                <option value="pentest">Penetration testing</option>
              </select>
            </div>
            <div class="w-clearfix w-col w-col-6">
              <label for="Scope" class="field-label-4">Scope info:</label>
              <textarea placeholder="All info about project scope" maxlength="5000" id="Scope" name="scope" data-name="Scope" class="textarea-8 w-input">{{escape(current_project['scope'])}}</textarea>
              <label class="w-checkbox checkbox-field-3 w-clearfix">
                <input type="checkbox" id="AutoArchive" name="archive" data-name="Auto Archive" class="w-checkbox-input" value="1" {% if current_project['auto_archive']==1 %} checked {% endif %}>
                <span for="AutoArchive" class="checkbox-label w-form-label">Auto archive project after finish date</span>
              </label>
              <input type="text" class="text-field-14 w-input" maxlength="256" name="start_date" data-name="Date" placeholder="Enter project start date" id="StartTime" default="1/1/1970" value="{{format_date(current_project['start_date'],'%m/%d/%Y')}}">
              <input type="text" class="text-field-15 w-input" maxlength="256" name="end_date" data-name="EndTime" placeholder="Enter project end date" id="EndTime" default="1/1/3000" value="{{format_date(current_project['end_date'],'%m/%d/%Y')}}">
            </div>
          </div>
          <label class="field-label-2">Choose teams for project:</label>

          {% set teams = db.select_user_teams(session['id']) %}
          {% for team in teams %}
          <label class="w-checkbox checkbox-field">
            <input type="checkbox" id="checkbox" name="teams-{{loop.index}}" data-name="Checkbox" class="w-checkbox-input" value="{{team['id']}}" {% if team['id'] in current_project['teams'] %} checked {% endif %} >
            <span class="w-form-label">{{escape(team['name'])}}</span>
          </label>
          {% endfor %}


          <label class="field-label-2">Choose testers for project:</label>


          {% set users = db.select_user_team_members(session['id']) %}
          {% for user in users %}
              {%  if user['id'] != session['id'] %}
                  <label class="w-checkbox checkbox-field-2">
                    <input type="checkbox" id="checkbox-3" name="users-{{loop.index}}" data-name="Checkbox 3" class="w-checkbox-input" value="{{user['id']}}" {% if user['id'] in current_project['testers'] or user['id'] == current_project['admin_id'] %} checked {% endif %}>
                    <span class="w-form-label">{{escape(user['fname'])}} {{escape(user['lname'])}} - {{escape(user['email'])}}</span>
                  </label>
              {% endif %}
          {% endfor %}


          <input type="submit" name="action" value="Update" data-wait="Please wait..." class="submit-button w-button">
          {% if current_project['status'] == 0 %}
          <input type="submit" name="action" value="Activate" class="button-47 w-button">
          {% else %}
          <input type="submit" name="action" value="Archive" data-wait="Please wait..." class="button-11 w-button">
          {% endif %}
        </form>
        <div class="success-message w-form-done"></div>
        {% if errors is defined %}
          {% for error in errors %}
            <div class="error-message w-form-fail" style="display: block">
              <div>{{error}}</div>
            </div>
          {% endfor %}
        {% endif %}
      </div>
    </div>
  </div>
  {% include 'footer.html' %}
  <script>
        $('#StartTime').datepicker();
        $('#EndTime').datepicker();
        var myForm = document.getElementById('email-form');

        myForm.addEventListener('submit', function () {
            var allInputs = myForm.getElementsByTagName('input');

            for (var i = 0; i < allInputs.length; i++) {
                var input = allInputs[i];

                if (input.name && !input.value) {
                    input.name = '';
                }
            }
        });
    </script>
</body>
</html>