<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Tue Jul 14 2020 19:54:27 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5f0e0a3314b1fb02109f7668" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns-43 w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-clearfix w-col w-col-11">
      <h1 class="heading-3">New credentials</h1>
      <div class="form-block-7 w-form">
        <form id="email-form" name="email-form" data-name="Email Form" method="post" action="/project/{{current_project['id']}}/credentials/new_creds">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
          <div class="w-row">
            <div class="w-col w-col-6">
              <label for="login">Login / email:</label>
              <input type="text" class="text-field-8 w-input" maxlength="256" name="login" data-name="Login" placeholder="admin" id="login">
              <label for="hash">Hash:</label>
              <input type="text" class="text-field-9 w-input" maxlength="256" name="password_hash" data-name="Hash" placeholder="21232f297a57a5a743894a0e4a801fc3" id="hash">
              <label for="hash_type">Hash type:</label>
              <select id="hash_type" name="hash_type" data-name="Hash Type" class="select-field-5 w-select">
                <option value="">None</option>
                <option value="md5_hex">MD5(hex)</option>
                <option value="sha1_hex">SHA1(hex)</option>
                <option value="sha256_hex">SHA256(hex)</option>
                <option value="sha512_hex">SHA512(hex)</option>
                <option value="md5_crypt_unix">MD5-Crypt Unix $1$...$...</option>
                <option value="des_crypt_unix">DES-Crypt Unix (old short)</option>
                <option value="sha256_crypt_unix">SHA256-Crypt Unix $5$...$...</option>
                <option value="sha512_crypt_unix">SHA512-Crypt Unix $6$...$...</option>
                <option value="ntlm_hex">NTLM or NT(hex)</option>
                <option value="lm_hex">LM(hex)</option>
                <option value="rabbitmq_md5">RabbitMQ MD5(base64)</option>
                <option value="Other">Other</option>
              </select>
              <label for="check_pwd">Check hash in wordlist:</label>
              <select id="check_pwd" name="check_pwd" data-name="check_pwd" class="select-field-17 w-select">
                  <option value="">-</option>
                  <option value="top10k">Top-10k passwords (2019)</option>
              </select>
              <label for="cleartext">Cleartext password:</label>
              <input type="text" class="text-field-10 w-input" maxlength="256" name="cleartext_password" data-name="Cleartext" placeholder="admin" id="cleartext">
              <label for="description">Comment:</label>
              <input type="text" class="text-field-11 w-input" maxlength="256" name="comment" data-name="Description" placeholder="Credentials description" id="description">
              <label for="source">Information source:</label>
              <input type="text" class="text-field-12 w-input" maxlength="256" name="info_source" data-name="Source" placeholder="Where did you find this credentials" id="source">
            </div>
            <div class="column-210 w-col w-col-6">
              <div class="w-row">
              <div class="column-233 w-clearfix w-col w-col-6">
              <label for="hash_type-2" class="field-label-16">ip-service:</label>
              <div class="div-block-9">
                <input type="text" placeholder="ip" id="ip_input" style="float:left;">
              </div>
              <div class="div-block-9">


                <!-- -->
                {% set count = [1] %}
                {% set ports = db.select_project_pair_host_port(current_project['id']) %}
                {% for port in ports %}
                    {% if count.append(count.pop() + 1) %} {% endif %}

                    <label class="w-checkbox" id="ip_row">
                      <input type="checkbox" id="checkbox" name="ip_port-{{count[0]}}" data-name="Checkbox" class="w-checkbox-input" value="{{port['port_id']}}">
                      <span class="w-form-label">{{escape(port['ip'])}}{% if port['port'] != 0 %}:{{escape(port['port'])}}{% endif %}{% if not port['is_tcp'] %} (udp) {% endif %}</span>
                    </label>
                {% endfor %}


                <!-- -->



              </div>
              </div>
              <div class="w-clearfix w-col w-col-6">
              <label for="hash_type-2" class="field-label-27">domain-service:</label>
              <div class="div-block-9">
                    <input type="text" placeholder="hostname" id="hostname_input" style="float:left;">
              </div>
              <div class="div-block-9">


                <!-- -->
                {% set count = [1] %}
                {% set ports = db.select_project_pair_hostname_port(current_project['id']) %}
                {% for port in ports %}
                    {% if count.append(count.pop() + 1) %} {% endif %}
                    <label class="w-checkbox" id="hostname_row">
                      <input type="checkbox" id="checkbox-10" name="host_port-{{count[0]}}" data-name="Checkbox 10" class="w-checkbox-input" value="{{port['port_id']}}:{{port['hostname_id']}}">
                      <span class="w-form-label">{{escape(port['hostname'])}}{% if port['port'] != 0 %}:{{escape(port['port'])}}{% endif %}{% if not port['is_tcp'] %} (udp) {% endif %}</span>
                    </label>

                {% endfor %}

                <!-- -->



              </div>
              </div>
            </div>
            </div>
          </div>
          <input type="submit" value="Submit" data-wait="Please wait..." class="submit-button-20 w-button">
        </form>
          <script>
              $('#ip_input').on('keyup', function(){
                  var $this = $(this),
                      val = $this.val();
                      var elements = document.querySelectorAll('[id=ip_row]');
                      for(var i=0; i<elements.length; i++) {
                        data = elements[i].children[1].textContent;
                        if ( (data.includes(val)) || (val === '') ){
                            elements[i].style.display = 'block';
                        } else {
                            elements[i].style.display = 'none';
                        }
                  }
              });

              $('#hostname_input').on('keyup', function(){
                  var $this = $(this),
                      val = $this.val();
                      var elements = document.querySelectorAll('[id=hostname_row]');
                      for(var i=0; i<elements.length; i++) {
                        data = elements[i].children[1].textContent;
                        if ( (data.includes(val)) || (val === '') ){
                            elements[i].style.display = 'block';
                        } else {
                            elements[i].style.display = 'none';
                        }
                  }
              })
        </script>
        {% if errors is defined and errors != [] %}
            {% for error in errors %}
              <div class="error-message w-form-fail" style="display: block">
                  <div>{{error}}</div>
              </div>
            {% endfor %}
        {% endif %}
      </div>
    </div>
  </div>
  {% include 'footer.html' %}
</body>
</html>