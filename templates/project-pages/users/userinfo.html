<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Jul 06 2020 16:48:25 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5eee5fce0be604ca5a4940bb" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns-43 w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-clearfix w-col w-col-11">
      <div class="column w-clearfix w-col w-col-11">
      <h1 class="heading-3">User info</h1>
      <div class="form-block-7 w-form">
        <form id="email-form" name="email-form" data-name="Email Form" method="post" action="/project/{{current_project['id']}}/credentials/{{current_creds['id']}}/" onsubmit="return delete_prompt(this,'Are you sure to update or delete credentials?')">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
          <div class="w-row">
            <div class="w-col w-col-6">
              <label for="login">Login / email:</label>
              <input type="text" class="text-field-8 w-input" maxlength="256" name="login" data-name="login" placeholder="admin" id="login" value="{{escape(current_creds['login'])}}">
              <label for="hash">Hash:</label>
              <input type="text" class="text-field-9 w-input" maxlength="256" name="password_hash" data-name="hash" placeholder="21232f297a57a5a743894a0e4a801fc3" id="hash" value="{{escape(current_creds['hash'])}}">
              <label for="hash_type">Hash type:</label>
              <select id="hash_type" name="hash_type" data-name="hash_type" class="select-field-5 w-select">
                <option value="{{escape(current_creds['hash_type'])}}">{{escape(current_creds['hash_type'])}}</option>
                <option value="">None</option>
                <option value="MD5">MD5</option>
                <option value="SHA1">SHA1</option>
                <option value="Other">Other</option>
              </select>
              <label for="cleartext">Cleartext password:</label>
              <input type="text" class="text-field-10 w-input" maxlength="256" name="cleartext_password" data-name="cleartext" placeholder="admin" id="cleartext" value="{{escape(current_creds['cleartext'])}}">
              <label for="description">Comment:</label>
              <input type="text" class="text-field-11 w-input" maxlength="256" name="comment" data-name="description" placeholder="Credentials description" id="description" value="{{escape(current_creds['description'])}}">
              <label for="source">Information source:</label>
              <input type="text" class="text-field-12 w-input" maxlength="256" name="info_source" data-name="source" placeholder="Where did you find this credentials" id="source" value="{{escape(current_creds['source'])}}">
            </div>
            <div class="column-210 w-col w-col-6">
              <div class="w-row">
              <div class="column-233 w-clearfix w-col w-col-6">
              <label for="hash_type-2" class="field-label-16">ip-service:</label>
              <div class="div-block-9">
                <input type="text" placeholder="ip" id="ip_input" style="float:left;">
              </div>
              <div class="div-block-9">

                {% set hosts = db.select_project_hosts(current_project['id']) %}
                {% set count = [1] %}
                {% set creds_service_dict = json_unpack(current_creds['services']) %}
                {% for host in hosts %}
                    {% set ports = db.select_host_ports(host['id']) %}
                    {% for port in ports %}
                        {% if count.append(count.pop() + 1) %} {% endif %}
                        <label class="w-checkbox" id="ip_row">
                            <input type="checkbox" id="checkbox" name="ip_port-{{count[0]}}" data-name="Checkbox" class="w-checkbox-input" value="{{port['id']}}" {% if port['id'] in creds_service_dict and "0" in creds_service_dict[port['id']] %}checked{% endif %}/>
                            <span class="w-form-label">{{escape(host['ip'])}}:{{port['port']}}{% if not port['is_tcp'] %} (udp) {% endif %}</span>
                        </label>
                        {% endfor %}
                {% endfor %}

              </div>
              </div>
              <div class="w-clearfix w-col w-col-6">
              <label for="hash_type-2" class="field-label-27">domain-service:</label>
              <div class="div-block-9">
                    <input type="text" placeholder="hostname" id="hostname_input" style="float:left;">
              </div>
              <div class="div-block-9">
                {% set count = [1] %}
                {% for host in hosts %}
                    {% set hostnames = db.select_ip_hostnames(host['id']) %}
                    {% set ports = db.select_host_ports(host['id']) %}
                    {% for hostname in hostnames %}
                        {% for port in ports %}
                            {% if count.append(count.pop() + 1) %} {% endif %}
                            <label class="w-checkbox" id="hostname_row">
                                <input type="checkbox" id="checkbox-10" name="host_port-{{count[0]}}" data-name="Checkbox 10" class="w-checkbox-input" value="{{port['id']}}:{{hostname['id']}}" {% if port['id'] in creds_service_dict and hostname['id'] in creds_service_dict[port['id']] %}checked{% endif %} />
                                <span class="w-form-label">{{escape(hostname['hostname'])}}:{{escape(port['port'])}}{% if not port['is_tcp'] %} (udp) {% endif %}</span>
                            </label>
                        {% endfor %}
                    {% endfor %}
                {% endfor %}
              </div>
              </div>
              </div>
            </div>
          </div>
          <button type="submit" name="action" value="update" data-wait="Please wait..." class="submit-button-14 w-button">Update</button>
          <button type="submit" name="action" value="delete" class="button-30 w-button">Delete</button>
        </form>
        <script>
              $('#ip_input').on('keyup', function(){
                  var $this = $(this),
                      val = $this.val();
                      var elements = document.querySelectorAll('[id=ip_row]');
                      for(var i=0; i<elements.length; i++) {
                        data = elements[i].children[1].textContent;
                        if ( (data.includes(val)) || (val === '') ){
                            elements[i].style.display = 'block';
                        } else {
                            elements[i].style.display = 'none';
                        }
                  }
              });

              $('#hostname_input').on('keyup', function(){
                  var $this = $(this),
                      val = $this.val();
                      var elements = document.querySelectorAll('[id=hostname_row]');
                      for(var i=0; i<elements.length; i++) {
                        data = elements[i].children[1].textContent;
                        if ( (data.includes(val)) || (val === '') ){
                            elements[i].style.display = 'block';
                        } else {
                            elements[i].style.display = 'none';
                        }
                  }
              })
        </script>
        <div class="w-form-done">
          <div>Thank you! Your submission has been received!</div>
        </div>
        {% if errors is defined and errors != [] %}
            {% for error in errors %}
              <div class="error-message w-form-fail" style="display: block">
                  <div>{{error}}</div>
              </div>
            {% endfor %}
        {% endif %}
      </div>
    </div>
  </div>
  {% include 'footer.html' %}
</body>
</html>