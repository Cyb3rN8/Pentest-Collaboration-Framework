<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Wed Jul 15 2020 00:17:38 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5eee53ace9cf276667e71f47" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns-35 w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-clearfix w-col w-col-11">
      {% set creds_array = db.select_project_creds(current_project['id']) %}
      <h1 class="heading-3">Credentials: {{len(creds_array)}}</h1>
      <a href="/project/{{current_project['id']}}/credentials/new_creds" class="button-29 w-button">Add</a>
      <a href="/project/{{current_project['id']}}/credentials/import_creds" class="button-57 w-button">Multiple add</a>
      <script>
            $(document).ready(function() {
                $('#example').DataTable( {
                    "order": [[ 0, "desc" ]],
                    "iDisplayLength": 10
                } );
            } );
        </script>
        <table id="example" class="display">
        <thead>
            <tr id="table_header">
                <th style="width: 16.66666667%; border-top-left-radius: 8px;"><h4>login / email</h4></th>
                <th style="width: 25%;"><h4>hash</h4></th>
                <th style="width: 16.66666667%;"><h4>password</h4></th>
                <th style="width: 25%;"><h4>comment</h4></th>
                <th style="width: 16.66666667%; border-top-right-radius: 8px;"><h4>service</h4></th>
            </tr>
        </thead>
        <tbody>
            {% for current_cred in creds_array %}
            <tr>
                <td>
                    <a href="/project/{{current_project['id']}}/credentials/{{current_cred['id']}}/" class="link-2">{{current_cred['login']}}</a>
                </td>
                <td>
                    <div class="text-block-31" style="word-break: break-all; white-space:pre-wrap;">{{current_cred['hash']}}</div>
                </td>
                <td>
                    <div class="text-block-31" style="word-break: break-all; white-space:pre-wrap;">{{current_cred['cleartext']}}</div>
                </td>
                <td>
                    <div class="text-block-31" style="word-break: break-all; white-space:pre-wrap;">{{current_cred['description']}}</div>
                </td>
                <td>
                      {% set addresses = json_unpack(current_cred['services']) %}
                      {% for port_id in addresses %}
                          {% set port = db.select_port(port_id)[0] %}
                          {% for host in addresses[port_id] %}
                              {% if host=="0" %}
                                  {% set ip = db.select_host_by_port_id(port_id)[0] %}
                                  <div class="text-block-31" style="word-break: break-all; white-space:pre-wrap;">{{escape(ip['ip'])}}:{{escape(port['port'])}}</div>
                              {% else %}
                                  {% set hostname = db.select_hostname(host)[0] %}
                                  <div class="text-block-31" style="word-break: break-all; white-space:pre-wrap;">{{escape(hostname['hostname'])}}:{{escape(port['port'])}}</div>
                              {% endif %}
                          {% endfor %}
                      {% endfor %}
                </td>
            </tr>
            {% endfor %}

        </tbody>
        </table>

        <style>
            th{
                padding:0px;
                margin-top: 0px;
                margin-bottom: 0px;
                height: 30px;
            }
            h4{
                margin-top: 0px; margin-bottom: 0px; text-align: left; padding-left: 10px
            }
            table.dataTable thead th, table.dataTable thead td{
                padding: 0px 0px;
                height: 30px;
                background-color: #c0f7ff;
            }
            table.dataTable.stripe tbody tr.odd, table.dataTable.display tbody tr.odd{
                background-color: #fffdc2;
            }
            table.dataTable.stripe tbody tr.odd, table.dataTable.display tbody tr.even{
                background-color: #c3ffcd;
            }
            .custom-clickable-row {
                cursor: pointer;
            }
            table.dataTable.display tbody tr.odd > .sorting_1, table.dataTable.order-column.stripe tbody tr.odd > .sorting_1{
                background-color: transparent;
            }
            table.dataTable.display tbody tr.even > .sorting_1, table.dataTable.order-column.stripe tbody tr.even > .sorting_1{
                background-color: transparent;
            }
            table.dataTable tbody th, table.dataTable tbody td {
                padding: 0px 0px;
                padding-top: 5px;
                padding-bottom: 5px;
            }
        </style>


      <!-- -->

      <div class="form-block-11 w-clearfix w-form">
        <h1 class="heading-3">Export</h1>
        <form id="email-form" name="email-form" data-name="Email Form" class="w-clearfix" method="post" action="/project/{{current_project['id']}}/credentials/export">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
          <label class="w-checkbox checkbox-field-9">
              <input type="checkbox" id="checkbox" name="empty_passwords" value="1" data-name="Checkbox" class="w-checkbox-input">
              <span class="w-form-label">Take raws with empty passwords</span>
          </label>
          <label class="w-checkbox checkbox-field-9">
              <input type="checkbox" id="checkbox-2" name="login_as_password" value="1" data-name="Checkbox 2" class="w-checkbox-input">
              <span class="w-form-label">Add logins to password list</span>
          </label>
          <label class="w-checkbox checkbox-field-9">
              <input type="checkbox" id="checkbox-2" name="show_in_browser" value="1" data-name="Checkbox 2" class="w-checkbox-input">
              <span class="w-form-label">Just show result in browser</span>
          </label>
          <label for="separator" class="field-label-28">Login:Password separator</label>
          <input type="text" class="text-field-19 w-input" maxlength="256" name="separator" data-name="separator" placeholder=";" id="separator" value=";">
          <input type="submit" name="export_type" value="passwords" data-wait="Please wait..." class="submit-button-21 w-button">
          <input type="submit" name="export_type" value="user_pass" data-wait="Please wait..." class="submit-button-22 w-button">
          <input type="submit" name="export_type" value="user_pass_variations" data-wait="Please wait..." class="submit-button-23 w-button">
          <input type="submit" name="export_type" value="usernames" data-wait="Please wait..." class="submit-button-23 w-button">
        </form>
      </div>
    </div>
  </div>
 {% include 'footer.html' %}
</body>
</html>