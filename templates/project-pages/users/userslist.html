<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Wed Jul 15 2020 00:17:38 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5eee53ace9cf276667e71f47" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns-35 w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-clearfix w-col w-col-11">
      <h1 class="heading-3">Credentials</h1>
      <a href="/project/{{current_project['id']}}/credentials/new_creds" class="button-29 w-button">Add</a>
      <div class="columns-41 w-row">
        <div class="column-189 w-col w-col-2">
          <div class="text-block-8">login / email</div>
        </div>
        <div class="column-190 w-col w-col-3">
          <div class="text-block-8">hash</div>
        </div>
        <div class="column-191 w-col w-col-2">
          <div class="text-block-8">password</div>
        </div>
        <div class="column-192 w-col w-col-3">
          <div class="text-block-8">comment</div>
        </div>
        <div class="column-193 w-col w-col-2">
          <div class="text-block-8">service</div>
        </div>
      </div>

      <!-- -->

      {% set creds_array = db.select_project_creds(current_project['id']) %}

      {% for current_cred in creds_array %}
          {% if loop.index % 2  == 0 %}
          <div class="columns-42 w-row">
          {% else %}
          <div class="columns-9 w-row">
          {% endif %}
            <div class="column-194 w-col w-col-2">
              <a href="/project/{{current_project['id']}}/credentials/{{current_cred['id']}}/" class="link-2">{{current_cred['login']}}</a>
            </div>
            <div class="column-195 w-col w-col-3">
              <div class="text-block-31">{{current_cred['hash']}}</div>
            </div>
            <div class="column-196 w-col w-col-2">
              <div class="text-block-31">{{current_cred['cleartext']}}</div>
            </div>
            <div class="column-197 w-col w-col-3">
              <div class="text-block-31">{{current_cred['description']}}</div>
            </div>
            <div class="column-198 w-col w-col-2">

          {% set addresses = json_unpack(current_cred['services']) %}
              {% for port_id in addresses %}
                  {% set port = db.select_port(port_id)[0] %}
                  {% for host in addresses[port_id] %}
                      {% if host=="0" %}
                          {% set ip = db.select_host_by_port_id(port_id)[0] %}
                          <div class="text-block-31">{{escape(ip['ip'])}}:{{escape(port['port'])}}</div>
                      {% else %}
                          {% set hostname = db.select_hostname(host)[0] %}
                          <div class="text-block-31">{{escape(hostname['hostname'])}}:{{escape(port['port'])}}</div>
                      {% endif %}
                  {% endfor %}
              {% endfor %}
            </div>
          </div>

      {% endfor %}


      <!-- -->

      <div class="form-block-11 w-clearfix w-form">
        <h1 class="heading-3">Export</h1>
        <form id="email-form" name="email-form" data-name="Email Form" class="w-clearfix" method="post" action="/project/{{current_project['id']}}/credentials/export">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
          <label class="w-checkbox checkbox-field-9">
              <input type="checkbox" id="checkbox" name="empty_passwords" value="1" data-name="Checkbox" class="w-checkbox-input">
              <span class="w-form-label">Take raws with empty passwords</span>
          </label>
          <label class="w-checkbox checkbox-field-9">
              <input type="checkbox" id="checkbox-2" name="login_as_password" value="1" data-name="Checkbox 2" class="w-checkbox-input">
              <span class="w-form-label">Add logins to password list</span>
          </label>
          <label for="separator" class="field-label-28">Separator</label>
          <input type="text" class="text-field-19 w-input" maxlength="256" name="separator" data-name="separator" placeholder=";" id="separator" value=";">
          <input type="submit" name="export_type" value="passwords" data-wait="Please wait..." class="submit-button-21 w-button">
          <input type="submit" name="export_type" value="user_pass" data-wait="Please wait..." class="submit-button-22 w-button">
          <input type="submit" name="export_type" value="user_pass_variations" data-wait="Please wait..." class="submit-button-23 w-button">
        </form>
      </div>
    </div>
  </div>
 {% include 'footer.html' %}
</body>
</html>