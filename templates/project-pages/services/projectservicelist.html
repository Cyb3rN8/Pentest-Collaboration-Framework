<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Jul 06 2020 16:48:25 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5edeadc152eb280380938bb3" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}

  <div class="columns w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-col w-col-11">
      <div class="w-row">
        <div class="w-clearfix w-col w-col-6">
          {% set ports = db.select_project_ports_grouped(current_project['id']) %}
          <h1 class="heading-3">Services: {{len(ports)}}</h1>
        </div>
        <div class="w-clearfix w-col w-col-6">
          <div class="form-block-2 w-clearfix w-form">
            <form id="email-form" name="email-form" data-name="Email Form" class="form-4 w-clearfix">
              <div class="columns-6 w-row">
                <div class="column-21 w-col w-col-10">
                  <!-- <input type="text" class="text-field-3 w-input" maxlength="256" name="query" data-name="Query" placeholder="Search..." id="query" required=""> -->
                </div>
                <div class="column-20 w-clearfix w-col w-col-2">
                  <!--
                  <input type="submit" value="Search" data-wait="Please wait..." class="submit-button-6 w-button">
                  -->
                  <a href="new_service" class="ipadd w-button">Add</a>
                </div>
              </div>
              <!-- <div class="text-block-25">Example: service=HTTP &amp; port=80 | threats&gt;=medium</div> -->
            </form>
            <div class="w-form-done">
              <div>Thank you! Your submission has been received!</div>
            </div>
            <div class="w-form-fail">
              <div>Oops! Something went wrong while submitting the form.</div>
            </div>
          </div>
        </div>
      </div>
      <div class="section">
        <div class="columns-2 w-row">
          <div class="column-2 w-col w-col-1">
            <div class="text-block-8">port</div>
          </div>
          <div class="column-3 w-col w-col-2">
            <div class="text-block-8">service</div>
          </div>
          <div class="column-4 w-col w-col-5">
            <div class="text-block-8">info</div>
          </div>
          <div class="column-5 w-col w-col-2">
            <div class="text-block-8">ip-addresses</div>
          </div>
          <div class="column-6 w-col w-col-2">
            <div class="text-block-8">threats</div>
          </div>
        </div>
      </div>
      <div class="section-3">



        {% for current_port in ports %}

        {% if loop.index % 2 == 0 %}
            <div class="column1 w-row">
        {% else %}
            <div class="column2 w-row">
        {% endif %}
          <div class="column-7 w-clearfix w-col w-col-1">
            <a href="/project/{{current_project['id']}}/hosts/?port={{current_port['port']}}%2f{{ 'tcp' if current_port['is_tcp'] else 'udp' }}&service={{urlencode(current_port['service'])}}" class="link">{{current_port['port']}}/{{ 'tcp' if current_port['is_tcp'] else 'udp' }}</a>
          </div>
          <div class="column-8 w-clearfix w-col w-col-2">
            <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;">{{escape(current_port['service'])}}</div>
          </div>
          <div class="column-9 w-clearfix w-col w-col-5">
            <div class="text-block-10" style="word-break: break-all; white-space:pre-wrap;">{{escape(current_port['description'])}}</div>
          </div>
          <div class="column-10 w-clearfix w-col w-col-2">
            {% if len(current_port['host_id']) > 5 %}
                {% for host_id in current_port['host_id'][:5] %}
                    <a href="/project/{{current_project['id']}}/host/{{host_id}}/" class="link">{{escape(db.select_project_host(current_project['id'], host_id)[0]['ip'])}}</a>
                {% endfor %}
                <a class="link">. . .</a>
                <a href="/project/{{current_project['id']}}/hosts/?port={{current_port['port']}}%2f{{ 'tcp' if current_port['is_tcp'] else 'udp' }}&service={{urlencode(current_port['service'])}}" class="link">{{len(current_port['host_id'])}} hosts at all</a>
            {% else %}
                {% for host_id in current_port['host_id'] %}
                    {% set host = db.select_project_host(current_project['id'], host_id) %}
                    <!-- TODO: delete -->
                    {% if not host %}
                        {% set to_del = db.delete_port_safe(current_port['id']) %}
                    {% endif %}
                    <a href="/project/{{current_project['id']}}/host/{{host_id}}/" class="link">{{escape(db.select_project_host(current_project['id'], host_id)[0]['ip'])}}</a>
                {% endfor %}
            {% endif %}
          </div>
          <div class="column-11 w-col w-col-2">
            <div class="div-block-5 w-clearfix">
              {% if 'critical' in current_port['issues'] %}
              <img src="/static/images/exclamation_mark_PNG64.png" srcset="/static/images/exclamation_mark_PNG64-p-500.png 500w, /static/images/exclamation_mark_PNG64.png 600w" sizes="30px" alt="" class="image-9">
              {% endif %}

              {% if 'high' in current_port['issues'] %}
              <img src="/static/images/kindpng_314237.png" srcset="/static/images/kindpng_314237-p-500.png 500w, /static/images/kindpng_314237.png 739w" sizes="30px" alt="" class="image-10">
              {% endif %}

              {% if 'medium' in current_port['issues'] %}
              <img src="https://uploads-ssl.webflow.com/5ec2ba8457c5c50b20b387c9/5f60c69556aed40887871443_output-onlinepngtools.png" loading="lazy" alt="" class="image-18">
              {% endif %}

              {% if 'low' in current_port['issues'] %}
              <img src="/static/images/kindpng_314604.png" srcset="/static/images/kindpng_314604-p-500.png 500w, /static/images/kindpng_314604.png 640w" sizes="30px" alt="" class="image-11">
              {% endif %}

              {% if 'info' in current_port['issues'] %}
              <img src="/static/images/pngwing.com.png" alt="" class="image-12">
              {% endif %}

              <!--
              <img src="/static/images/d6368d8155eb832733a200df87f48e92-purple-circle-question-mark-icon-by-vexels.png" srcset="/static/images/d6368d8155eb832733a200df87f48e92-purple-circle-question-mark-icon-by-vexels-p-500.png 500w, /static/images/d6368d8155eb832733a200df87f48e92-purple-circle-question-mark-icon-by-vexels.png 512w" sizes="(max-width: 767px) 32px, (max-width: 991px) 4vw, 30px" alt="" class="image-13">
              -->
            </div>
          </div>
        </div>

        {% endfor %}



      </div>
    </div>
  </div>
  {% include 'footer.html' %}
</body>
</html>