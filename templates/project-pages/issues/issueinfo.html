<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Jul 06 2020 16:48:25 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5eebcabf1c85a3d41621666b" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-clearfix w-col w-col-11" style="width: calc(100vw - 80px);overflow: hidden;">
      <h1 class="heading-3">Issue: {{escape(current_issue['name'])}}</h1>
      <div data-duration-in="300" data-duration-out="100" class="tabs-5 w-tabs">
        <div class="tabs-menu-3 w-tab-menu">
          <a data-w-tab="Info" class="tab-link-info w-inline-block w-tab-link w--current">
            <div>Info</div>
          </a>
          <a data-w-tab="PoC" class="tab-link-tab-3 w-inline-block w-tab-link">
            <div>PoC</div>
          </a>
        </div>
        <div class="tabs-content-2 w-tab-content">
          <div data-w-tab="Info" class="tab-pane-tab-1 w-tab-pane w--tab-active">
            <div class="w-form">
                <form id="email-form" name="email-form" data-name="Email Form" method="post" action="/project/{{current_project['id']}}/issue/{{current_issue['id']}}/">
                  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
				  <div class="columns-52 w-row">
                    <div class="column-224 w-clearfix w-col w-col-6"><label for="name" class="field-label-26">Vulnerability name</label>
					<input type="text" class="text-field-4 w-input" maxlength="256" name="name" data-name="Name" placeholder="SQL injection..." id="name" required="" value="{{escape(current_issue['name'])}}" />
					<label for="Description" class="field-label-25">Description</label>
					<textarea placeholder="Description text" maxlength="5000" id="Description" name="description" data-name="Description" class="textarea-5 w-input">{{escape(current_issue['description'])}}</textarea>
					<label for="Description" class="field-label-24">Services</label>
                      <div class="section-7">
                        <div class="columns-51 w-row">
                          <div class="column-226 w-col w-col-6">
						  {% set hosts = db.select_project_hosts(current_project['id']) %}
						  {% set count = [1] %}
						  {% set issue_service_dict = json_unpack(current_issue['services']) %}
						  {% for host in hosts %}
							  {% set ports = db.select_host_ports(host['id']) %}
							  {% for port in ports %}
								  {% if count.append(count.pop() + 1) %} {% endif %}
								  <label class="w-checkbox">
									  <input type="checkbox" id="checkbox-10" name="ip_port-{{count[0]}}" data-name="Checkbox 10" class="w-checkbox-input" value="{{port['id']}}" {% if port['id'] in issue_service_dict and "0" in issue_service_dict[port['id']] %}checked{% endif %}/>
									  <span class="checkbox-label-4 w-form-label">{{escape(host['ip'])}}:{{port['port']}}{% if not port['is_tcp'] %} (udp) {% endif %}</span>
								  </label>
								  {% endfor %}
						  {% endfor %}
						  </div>
                          <div class="column-227 w-col w-col-6">
							  {% set count = [1] %}
							  {% for host in hosts %}
								  {% set hostnames = db.select_ip_hostnames(host['id']) %}
								  {% set ports = db.select_host_ports(host['id']) %}
								  {% for hostname in hostnames %}
									  {% for port in ports %}
										  {% if count.append(count.pop() + 1) %} {% endif %}
										  <label class="w-checkbox">
											  <input type="checkbox" id="checkbox-10" name="host_port-{{count[0]}}" data-name="Checkbox 10" class="w-checkbox-input" value="{{port['id']}}:{{hostname['id']}}" {% if port['id'] in issue_service_dict and hostname['id'] in issue_service_dict[port['id']] %}checked{% endif %} />
											  <span class="checkbox-label-6 w-form-label">{{escape(hostname['hostname'])}}:{{escape(port['port'])}}{% if not port['is_tcp'] %} (udp) {% endif %}</span>
										  </label>
									  {% endfor %}
								  {% endfor %}
							  {% endfor %}
						  </div>
                        </div>
                      </div>
                    </div>
                    <div class="column-225 w-clearfix w-col w-col-6">
                      <div class="div-block-16 w-clearfix">
					  <label for="path" class="field-label-17">URL path (for web)</label>
					  <input type="text" class="text-field-4 w-input" maxlength="256" name="url" data-name="path" placeholder="/admin/" id="path" value="{{escape(current_issue['url_path'])}}" />
					  <label for="cvss-2" class="field-label-21">CVSS</label>
					  <input type="number" class="text-field-5 w-input" min="0" max="10" step="0.01" maxlength="256" name="cvss" data-name="Cvss" placeholder="0.0 - 10.0" id="cvss" value="{{escape(current_issue['cvss'])}}" />
					  <label for="cve" class="field-label-22">CVE number</label>
					  <input type="text" class="text-field-5 w-input" maxlength="256" name="cve" data-name="cve" placeholder="2020-1337" id="cve" value="{{escape(current_issue['cve'])}}" />
					  <label for="cwe" class="field-label-23">CWE number</label>
					  <input type="text" class="text-field-5 w-input" maxlength="256" name="cwe" data-name="cwe" placeholder="123" id="cwe" value="{{escape(current_issue['cwe'])}}" />
					  <label for="status" class="field-label-20">Status</label>
					  <select id="status" name="status" data-name="Status" required="" class="select-field-3 w-select">
					  <option value="{{escape(current_issue['status'])}}">{{escape(current_issue['status'])}}</option>
					  <option value="PoC creation">PoC creation</option>
					  <option value="PoC available">PoC available</option>
					  <option value="Confirmed">Confirmed</option>
					  <option value="Not comfirmed">Wasn&#x27;t comfirmed</option>
					  <option value="Pending...">Pending...</option>
					  <option value="Need to recheck">Need to recheck</option>
					  <option value="Need to check">Need to check</option>
					  </select>
                      <label for="status-2" class="field-label-20">Criticality</label>
					  <select id="status-2" name="criticality" data-name="Status 2" class="select-field-3 w-select">
						  <option value="-1">use CVSS criticality</option>
						  <option value="0">Information (cvss=0.0)</option>
						  <option value="5">Low (cvss=5.0)</option>
						  <option value="7.5">Medium (cvss=7.5)</option>
						  <option value="9.5">High (cvss=9.5)</option>
					  </select>
					  </div>
					  <input type="submit" value="Submit" data-wait="Please wait..." class="submit-button-11 w-button" />
                    </form>
                    <form action="/project/{{current_project['id']}}/issue/{{current_issue['id']}}/delete_issue" method="post" onsubmit="return delete_prompt(this,'Are you sure to delete issue?')">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <button type="submit" class="button-36 w-button">Delete</button>
                    </form>
                    </div>
                  </div>
				  {% if update_info_errors is defined and update_info_errors != [] %}
					  {% for error in update_info_errors %}
						<div class="error-message w-form-fail" style="display: block">
							<div>{{error}}</div>
						</div>
					  {% endfor %}
				  {% endif %}
              </div>
          </div>
          <div data-w-tab="PoC" class="w-tab-pane">
            <div class="w-row">
              <div class="column-156 w-col w-col-2">
                <div class="text-block-8">host</div>
              </div>
              <div class="column-157 w-col w-col-3">
                <div class="text-block-8">comment</div>
              </div>
              <div class="column-158 w-col w-col-6">
                <div class="text-block-8">proof-of-concept</div>
              </div>
              <div class="column-159 w-col w-col-1"></div>
            </div>

            <!-- -->


            {% set pocs = db.select_issue_pocs(current_issue['id']) %}
            {% for current_poc in pocs %}
                  {% if loop.index % 2  == 0 %}
                      <div class="columns-34 w-row">
                  {% else %}
                      <div class="column200 w-row">
                  {% endif %}
                  <div class="column-164 w-clearfix w-col w-col-2">
                    {% if not (current_poc['hostname_id']=='0' and current_poc['port_id']=='0') %}
                        {% if current_poc['hostname_id']=='0' %}
                            {% set host = db.select_host_by_port_id(current_poc['port_id'])[0]['ip'] %}
                        {% else %}
                            {% set host = db.select_hostname(current_poc['hostname_id'])[0]['hostname'] %}
                        {% endif %}
                        {% set current_port = db.select_port(current_poc['port_id'])[0] %}
                        <div class="text-block-10">{{escape(host)}}:{{escape(current_port['port'])}}</div>
                    {% endif %}
                  </div>
                  <div class="column-165 w-clearfix w-col w-col-3">
                    <div class="text-block-10">{{escape(current_poc['description'])}}</div>
                  </div>
                  <div class="column-166 w-col w-col-6">
                    {% if current_poc['type']=='image' %}
                        <div class="centered-container w-container">
                            <img src="/static/files/poc/{{current_poc['id']}}" alt="" class="image-14" style="max-height: 400px;">
                        </div>
                     {% else %}{% autoescape false %}<pre><code style="max-height: 400px; margin-left: 10px; margin-right: 10px;">{{ escape(open('static/files/poc/'+current_poc['id']).read()) }}</code></pre>{% endautoescape %}{% endif %}
                  </div>
                  <div class="column-167 w-col w-col-1">
                    <form action="/project/{{current_project['id']}}/issue/{{current_issue['id']}}/delete_poc" method="post" onsubmit="return delete_prompt(this,'Are you sure to delete PoC?')">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <input type="hidden" name="poc_id" value="{{ current_poc['id'] }}"/>
                        <button type="submit" class="button-23 w-button">Delete</button>
                    </form>
                    <a href="/static/files/poc/{{current_poc['id']}}" class="button-41 w-button">Download</a>
                  </div>
                </div>

            {% endfor %}




            <!-- -->
            <div class="w-form">
              <form id="email-form-2" name="email-form-2" data-name="Email Form 2" method="post" action="/project/{{current_project['id']}}/issue/{{current_issue['id']}}/new_poc" enctype="multipart/form-data">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                <div class="columns-36 w-row">
                  <div class="column-168 w-col w-col-2">
                    <select id="field-3" name="service" class="w-select">
                       <option value="0:0">No service</option>
                      {% set targets = json_unpack(current_issue['services']) %}
                      {% for port_id in targets %}
                          {% set current_port = db.select_port(port_id)[0] %}
                          {% for hostname_id in targets[port_id] %}
                              {% if hostname_id=='0' %}
                                  {% set host = db.select_host_by_port_id(port_id)[0] %}
                                  <option value="{{port_id}}:0">{{escape(host['ip'])}}:{{escape(current_port['port'])}}</option>
                              {% else %}
                                  {% set current_hostname=db.select_hostname(hostname_id)[0] %}
                                  <option value="{{port_id}}:{{hostname_id}}">{{escape(current_hostname['hostname'])}}:{{escape(current_port['port'])}}</option>
                              {% endif %}
                          {% endfor %}
                      {% endfor %}
                    </select>
                  </div>
                  <div class="column-169 w-col w-col-3">
                    <input type="text" class="w-input" maxlength="256" name="comment" data-name="Field 2" placeholder="Example Text" id="field-2" required="">
                  </div>
                  <div class="column-170 w-col w-col-6">
                    <input type="file" class="w-input"name="file" data-name="File" placeholder="Insert text file or Image upload form" id="File" required="">
                  </div>
                  <div class="column-171 w-col w-col-1">
                    <input type="submit" value="Submit" data-wait="Please wait..." class="submit-button-12 w-button">
                  </div>
                </div>
              </form>
              {% if poc_errors is defined and poc_errors != [] %}
                  {% for error in poc_errors %}
                    <div class="error-message w-form-fail" style="display: block">
                        <div>{{error}}</div>
                    </div>
                  {% endfor %}
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% include 'footer.html' %}
</body>
</html>