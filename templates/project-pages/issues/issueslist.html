<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Jul 06 2020 16:48:25 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5eeaa3d5d068287ed87fd8d9" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-col w-col-11">
      <div class="columns-28 w-row">
        <div class="w-clearfix w-col w-col-6">
          <h1 class="heading-3">Issues</h1>
        </div>
        <div class="w-clearfix w-col w-col-6">
          <div class="form-block-2 w-clearfix w-form">
            <form id="email-form" name="email-form" data-name="Email Form" class="form-4 w-clearfix" action="/project/{{current_project['id']}}/issues/" method="get">
              <div class="columns-6 w-row">
                <div class="column-21 w-col w-col-10">
                  <input type="text" class="text-field-3 w-input" maxlength="256" name="search" data-name="Query" placeholder="Search..." id="query" {% if 'search' in request.args %} value="{{escape(request.args['search'])}}" {% endif %}}></div>
                <div class="column-20 w-clearfix w-col w-col-2">
                    <button type="submit" value="Search"class="submit-button-6 w-button">Search</button>
                  <a href="/project/{{current_project['id']}}/new_issue" class="ipadd w-button">Add</a>
                </div>
              </div>
            </form>
            <div class="text-block-24">name=&#x27;Admin page&#x27; &amp; description=&#x27;%index.php%&#x27; | addresses &gt; 0</div>
            <div class="w-form-done">
              <div>Thank you! Your submission has been received!</div>
            </div>
            <div class="w-form-fail">
              <div>Oops! Something went wrong while submitting the form.</div>
            </div>
          </div>
        </div>
      </div>
      <div class="columns-29 w-row">
        <div class="column-125 w-col w-col-2">
          <div class="text-block-8">name</div>
        </div>
        <div class="column-126 w-col w-col-4">
          <div class="text-block-8">description</div>
        </div>
        <div class="column-127 w-col w-col-2">
          <div class="text-block-8">addresses</div>
        </div>
        <div class="column-128 w-col w-col-1">
          <div class="text-block-8">CVSS</div>
        </div>
        <div class="column-129 w-col w-col-2">
          <div class="text-block-8">status</div>
        </div>
        <div class="column-135 w-col w-col-1"></div>
      </div>

      <!-- -->
      {% if 'search' in request.args %}
            {% set issues = db.search_issues(current_project['id'], request.args['search'] ) %}
      {% else %}
            {% set issues = db.select_project_issues(current_project['id']) %}
      {% endif %}

      {% for issue in issues %}
          {% if issue['cvss']>=0  and issue['cvss']<=3.9 %}
              <div class="columns-33 w-row">
          {% elif issue['cvss']>3.9 and issue['cvss']<=6.9 %}
              <div class="columns-32 w-row">
          {% elif issue['cvss']>6.9 and issue['cvss']<=8.9 %}
              <div class="columns-31 w-row">
          {% else %}
              <div class="columns-30 w-row">
          {% endif %}
            <div class="column-130 w-clearfix w-col w-col-2">
              <div class="text-block-10">{{escape(issue['name'])}}</div>
            </div>
            <div class="column-131 w-clearfix w-col w-col-4">
              <div class="text-block-10" style="white-space:pre-wrap;">{{escape('\n'.join(issue['description'].split('\n')[:5]))}}</div>
            </div>
            <div class="column-132 w-col w-col-2">
              {% set addresses = json_unpack(issue['services']) %}
              {% for port_id in addresses %}
                  {% set port = db.select_port(port_id)[0] %}
                  {% for host in addresses[port_id] %}
                      {% if host=="0" %}
                          {% set ip = db.select_host_by_port_id(port_id)[0] %}
                          <div class="text-block-26">{{escape(ip['ip'])}}:{{escape(port['port'])}}</div>
                      {% else %}
                          {% set hostname = db.select_hostname(host)[0] %}
                          <div class="text-block-26">{{escape(hostname['hostname'])}}:{{escape(port['port'])}}</div>
                      {% endif %}
                  {% endfor %}
              {% endfor %}
            </div>
            <div class="column-133 w-clearfix w-col w-col-1">
              <div class="text-block-10">{{escape(issue['cvss'])}}</div>
            </div>
            <div class="column-134 w-col w-col-2">
              <div class="text-block-10">{{escape(issue['status'])}}</div>
            </div>
            <div class="column-136 w-col w-col-1">
              <a href="/project/{{current_project['id']}}/issue/{{issue['id']}}/" class="button-22 w-button">Open</a>
            </div>
          </div>

      {% endfor %}

      <!-- -->


    </div>
  </div>
 {% include 'footer.html' %}
</body>
</html>