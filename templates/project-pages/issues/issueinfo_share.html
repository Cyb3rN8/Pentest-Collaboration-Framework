<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Jul 06 2020 16:48:25 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5eebcabf1c85a3d41621666b" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns w-row">
    <div class="column w-clearfix w-col w-col-11" style="width: calc(100vw - 80px);overflow: hidden;">
      <h1 class="heading-3">Issue: {{escape(current_issue['name'])}}</h1>
      <div data-duration-in="300" data-duration-out="100" class="tabs-5 w-tabs" style="text-align: left">
        <div class="tabs-menu-3 w-tab-menu">
          <a data-w-tab="Info" class="tab-link-info w-inline-block w-tab-link w--current">
            <div>Info</div>
          </a>
          <a data-w-tab="PoC" class="tab-link-tab-3 w-inline-block w-tab-link">
            <div>PoC</div>
          </a>
        </div>
        <div class="tabs-content-2 w-tab-content">
          <div data-w-tab="Info" class="tab-pane-tab-1 w-tab-pane w--tab-active">
            <div class="w-form">
                <form id="email-form" name="email-form" data-name="Email Form">
				  <div class="columns-52 w-row">
                    <div class="column-224 w-clearfix w-col w-col-6">
                        <label for="name" class="field-label-26">Vulnerability name</label>
					<input readonly type="text" class="text-field-4 w-input" maxlength="256" name="name" data-name="Name" placeholder="SQL injection..." id="name" required="" value="{{escape(current_issue['name'])}}" />
					<label for="Description" class="field-label-25">Description</label>
					<textarea readonly placeholder="Description text" maxlength="5000" id="Description" name="description" data-name="Description" class="textarea-5 w-input">{{escape(current_issue['description'])}}</textarea>
					<label for="fix" class="field-label-20">Fix</label>
					<input type="text" class="text-field-39 w-input" maxlength="256" name="fix" data-name="fix" placeholder="To fix this vulnerability you need ..." value="{{escape(current_issue['fix'])}}" id="fix" readonly>
                    <label for="Description" class="field-label-24">Services</label>
                        <div class="section-7">
                          <div class="w-row">
                          <div class="column-237 w-col w-col-6">
                              <input type="text" placeholder="ip" id="ip_input">
                          </div>
                          <div class="w-col w-col-6">
                              <input  type="text" placeholder="hostname" id="hostname_input">
                          </div>
                        </div>
                        <script>
                              $('#ip_input').on('keyup', function(){
                                  var $this = $(this),
                                      val = $this.val();
                                      var elements = document.querySelectorAll('[id=ip_row]');
                                      for(var i=0; i<elements.length; i++) {
                                        data = elements[i].children[1].textContent;
                                        if ( (data.includes(val)) || (val === '') ){
                                            elements[i].style.display = 'block';
                                        } else {
                                            elements[i].style.display = 'none';
                                        }
                                  }
                              });

                              $('#hostname_input').on('keyup', function(){
                                  var $this = $(this),
                                      val = $this.val();
                                  var elements = document.querySelectorAll('[id=hostname_row]');
                                  for(var i=0; i<elements.length; i++) {
                                    data = elements[i].children[1].textContent;
                                    if ( (data.includes(val)) || (val === '') ){
                                        elements[i].style.display = 'block';
                                    } else {
                                        elements[i].style.display = 'none';
                                    }
                              }
                              })
                        </script>
                        <div class="columns-51 w-row">
                          <div class="column-226 w-col w-col-6" id="ip-list">
						  {% set hosts = db.select_project_hosts(current_issue['project_id']) %}
						  {% set count = [1] %}
						  {% set issue_service_dict = json_unpack(current_issue['services']) %}
						  {% for host in hosts %}
							  {% set ports = db.select_host_ports(host['id']) %}
							  {% for port in ports %}
                                      {% if port['id'] in issue_service_dict and "0" in issue_service_dict[port['id']] %}
                                          <label class="w-checkbox" id="ip_row">
                                          {% if count.append(count.pop() + 1) %} {% endif %}
                                          <input readonly type="checkbox" id="checkbox-10" name="ip_port-{{count[0]}}" data-name="Checkbox 10" class="w-checkbox-input" value="{{port['id']}}" checked/>
                                          <span class="checkbox-label-4 w-form-label">{{escape(host['ip'])}}:{{port['port']}}{% if not port['is_tcp'] %} (udp) {% endif %}</span>
                                          </label>
                                      {% endif %}
							  {% endfor %}
						  {% endfor %}
						  </div>
                          <div class="column-227 w-col w-col-6">
							  {% set count = [1] %}
							  {% for host in hosts %}
								  {% set hostnames = db.select_ip_hostnames(host['id']) %}
								  {% set ports = db.select_host_ports(host['id']) %}
								  {% for hostname in hostnames %}
									  {% for port in ports %}
                                            {% if port['id'] in issue_service_dict and hostname['id'] in issue_service_dict[port['id']] %}
                                                  {% if count.append(count.pop() + 1) %} {% endif %}
                                                  <label class="w-checkbox" id="hostname_row">
                                                      <input readonly type="checkbox" id="checkbox-10" name="host_port-{{count[0]}}" data-name="Checkbox 10" class="w-checkbox-input" value="{{port['id']}}:{{hostname['id']}}" checked />
                                                      <span class="checkbox-label-6 w-form-label">{{escape(hostname['hostname'])}}:{{escape(port['port'])}}{% if not port['is_tcp'] %} (udp) {% endif %}</span>
                                                  </label>
                                            {% endif %}
									  {% endfor %}
								  {% endfor %}
							  {% endfor %}
						  </div>
                        </div>
                      </div>
                    </div>
                      <script>
                          var elements = document.querySelectorAll('[id=hostname_row]');
                          for(i=0; i<elements.length; i++) {
                                is_checked = elements[i].children[0].checked;
                                if ( is_checked ){
                                    elements[i].parentNode.prepend(elements[i]);
                                } else {

                                }
                          };
                          elements = document.querySelectorAll('[id=ip_row]');
                          for(i=0; i<elements.length; i++) {
                                is_checked = elements[i].children[0].checked;
                                if ( is_checked ){
                                    elements[i].parentNode.prepend(elements[i]);
                                } else {

                                }
                          }
                      </script>
                    <div class="column-225 w-clearfix w-col w-col-6">
                      <div class="div-block-16 w-clearfix">
					  <label for="path" class="field-label-17">URL path (for web)</label>
					  <input readonly type="text" class="text-field-4 w-input" maxlength="256" name="url" data-name="path" placeholder="/admin/" id="path" value="{{escape(current_issue['url_path'])}}" />
					  <label for="cvss-2" class="field-label-21">CVSS</label>
					  <input readonly type="number" class="text-field-5 w-input" min="0" max="10" step="0.01" maxlength="256" name="cvss" data-name="Cvss" placeholder="0.0 - 10.0" id="cvss" value="{{escape(current_issue['cvss'])}}" />
					  <label for="cve" class="field-label-22">CVE number</label>
					  <input readonly type="text" class="text-field-5 w-input" maxlength="256" name="cve" data-name="cve" placeholder="2020-1337" id="cve" value="{{escape(current_issue['cve'])}}" />
					  <label for="cwe" class="field-label-23">CWE number</label>
					  <input readonly type="text" class="text-field-5 w-input" maxlength="256" name="cwe" data-name="cwe" placeholder="123" id="cwe" value="{{escape(current_issue['cwe'])}}" />
					  <label for="status" class="field-label-20">Status</label>
					  <select disabled="disabled" id="status" name="status" data-name="Status" required="" class="select-field-3 w-select">
					  <option value="{{escape(current_issue['status'])}}">{{escape(current_issue['status'])}}</option>
					  <option value="PoC creation">PoC creation</option>
					  <option value="PoC available">PoC available</option>
					  <option value="Confirmed">Confirmed</option>
					  <option value="Not comfirmed">Wasn&#x27;t comfirmed</option>
					  <option value="Pending...">Pending...</option>
					  <option value="Need to recheck">Need to recheck</option>
					  <option value="Need to check">Need to check</option>
					  </select>
                      <label for="status-2" class="field-label-20">Criticality</label>
					  <select id="status-2" disabled="disabled" name="criticality" data-name="Status 2" class="select-field-3 w-select">
						  <option value="-1">use CVSS criticality</option>
						  <option value="0">Information (cvss=0.0)</option>
						  <option value="2">Low (cvss=2.0)</option>
						  <option value="5">Medium (cvss=5.0)</option>
						  <option value="8">High (cvss=8.0)</option>
						  <option value="9.5">Critical (cvss=9.5)</option>
					  </select>
                      <label for="param" class="field-label-20">Parameter</label>
					  <input type="text" class="text-field-40 w-input" maxlength="256" name="param" data-name="param" value="{{escape(current_issue['param'])}}" placeholder="GET id=123" id="param" readonly>
					  <label for="type" class="field-label-35">Type</label>
					  <select disabled="disabled"  id="type" name="issue_type" data-name="type" class="select-field-16 w-select">
                          <option value="{{escape(current_issue['type'])}}" selected>{{escape(current_issue['type'])}}</option>
						  <option value="custom">Custom</option>
						  <option value="web">Web</option>
						  <option value="credentials">Credentials</option>
						  <option value="service">Service</option>
					  </select>
					  </div>
                    </form>
                    </div>
                  </div>
              </div>
          </div>
          <div data-w-tab="PoC" class="w-tab-pane">
            <div class="w-row">
              <div class="column-156 w-col w-col-2">
                <div class="text-block-8">host</div>
              </div>
              <div class="column-157 w-col w-col-3">
                <div class="text-block-8">comment</div>
              </div>
              <div class="column-158 w-col w-col-6">
                <div class="text-block-8">proof-of-concept</div>
              </div>
              <div class="column-159 w-col w-col-1"></div>
            </div>

            <!-- -->


            {% set pocs = db.select_issue_pocs(current_issue['id']) %}
            {% for current_poc in pocs %}
                  {% if loop.index % 2  == 0 %}
                      <div class="columns-34 w-row">
                  {% else %}
                      <div class="column200 w-row">
                  {% endif %}
                  <div class="column-164 w-clearfix w-col w-col-2">
                    {% if not (current_poc['hostname_id']=='0' and current_poc['port_id']=='0') %}
                        {% if current_poc['hostname_id']=='0' %}
                            {% set host = db.select_host_by_port_id(current_poc['port_id'])[0]['ip'] %}
                        {% else %}
                            {% set host = db.select_hostname(current_poc['hostname_id'])[0]['hostname'] %}
                        {% endif %}
                        {% set current_port = db.select_port(current_poc['port_id'])[0] %}
                        <div class="text-block-10">{{escape(host)}}:{{escape(current_port['port'])}}</div>
                    {% endif %}
                  </div>
                  <div class="column-165 w-clearfix w-col w-col-3">
                    <div class="text-block-10">{{escape(current_poc['description'])}}</div>
                  </div>
                  <div class="column-166 w-col w-col-6">
                    {% if current_poc['type']=='image' %}
                        <div class="centered-container w-container">
                            <img src="/static/files/poc/{{current_poc['id']}}" alt="" class="image-14" style="max-height: 400px;">
                        </div>
                     {% else %}{% autoescape false %}<pre><code style="max-height: 400px; margin-left: 10px; margin-right: 10px;">{{ escape(open('static/files/poc/'+current_poc['id']).read()) }}</code></pre>{% endautoescape %}{% endif %}
                  </div>
                  <div class="column-167 w-col w-col-1">
                    <a href="/static/files/poc/{{current_poc['id']}}" class="button-41 w-button">Download</a>
                  </div>
                </div>

            {% endfor %}


          </div>
        </div>
      </div>
    </div>
  </div>
  {% include 'footer.html' %}
</body>
</html>