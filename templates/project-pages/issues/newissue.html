<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Mon Jul 06 2020 16:48:25 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5eeb7b656eabd95d577f8ba5" data-wf-site="5ec2ba8457c5c50b20b387c9">
{% include 'header.html' %}
<body>
  {% include 'navbar.html' %}
  <div class="columns w-row">
    {% include 'project-pages/menu.html' %}
    <div class="column w-col w-col-11">
      <div class="columns-28 w-row">
        <div class="w-clearfix w-col w-col-6">
          <h1 class="heading-3">Create new issues</h1>
        </div>
        <div class="column-155 w-col w-col-6"></div>
      </div>
      <div class="w-form">
                <form id="email-form" name="email-form" data-name="Email Form" method="post" action="/project/{{current_project['id']}}/new_issue">
                  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
				  <div class="columns-52 w-row">
                    <div class="column-224 w-clearfix w-col w-col-6">
						<label for="name" class="field-label-26">Vulnerability name</label>
					<input type="text" class="text-field-4 w-input" maxlength="256" name="name" data-name="Name" placeholder="SQL injection..." id="name" required="" />
					<label for="Description" class="field-label-25">Description</label>
					<textarea placeholder="Description text" maxlength="5000" id="Description" name="description" data-name="Description" class="textarea-5 w-input"></textarea>
					<label for="fix" class="field-label-20">Fix</label>
					<input type="text" class="text-field-39 w-input" maxlength="256" name="fix" data-name="fix" placeholder="To fix this vulnerability you need ..." id="fix">
					<label for="Description" class="field-label-24">Services</label>
						<div class="section-7">
                          <div class="w-row">
                          <div class="column-237 w-col w-col-6">
                              <input type="text" placeholder="ip" id="ip_input">
                          </div>
                          <div class="w-col w-col-6">
                              <input type="text" placeholder="hostname" id="hostname_input">
                          </div>
                        </div>
                        <script>
                              $('#ip_input').on('keyup', function(){
                                  var $this = $(this),
                                      val = $this.val();
                                      var elements = document.querySelectorAll('[id=ip_row]');
                                      for(var i=0; i<elements.length; i++) {
                                        data = elements[i].children[1].textContent;
                                        if ( (data.includes(val)) || (val === '') ){
                                            elements[i].style.display = 'block';
                                        } else {
                                            elements[i].style.display = 'none';
                                        }
                                  }
                              });

                              $('#hostname_input').on('keyup', function(){
                                  var $this = $(this),
                                      val = $this.val();
                                      var elements = document.querySelectorAll('[id=hostname_row]');
                                      for(var i=0; i<elements.length; i++) {
                                        data = elements[i].children[1].textContent;
                                        if ( (data.includes(val)) || (val === '') ){
                                            elements[i].style.display = 'block';
                                        } else {
                                            elements[i].style.display = 'none';
                                        }
                                  }
                              })
                        </script>
                      <div class="section-7">
                        <div class="columns-51 w-row">
                          <div class="column-226 w-col w-col-6">
						  {% set hosts = db.select_project_hosts(current_project['id']) %}
						  {% set count = [1] %}
						  {% for host in hosts %}
							  {% set ports = db.select_host_ports(host['id'],full=True) %}
							  {% for port in ports %}
								  {% if count.append(count.pop() + 1) %} {% endif %}
								  <label class="w-checkbox" id="ip_row">
									  <input type="checkbox" id="checkbox-10" name="ip_port-{{count[0]}}" data-name="Checkbox 10" class="w-checkbox-input" value="{{port['id']}}" {% if 'service' in request.args and request.args['service']==port['id'] and 'hostname' in request.args and request.args['hostname']=='0' %}checked{% endif %}/>
									  <span class="checkbox-label-4 w-form-label">{{escape(host['ip'])}}{% if port['port'] !=0 %}:{{port['port']}}{% if not port['is_tcp'] %} (udp) {% endif %}</span>
								  </label>
								  {% endfor %}
						  {% endfor %}
						  </div>
                          <div class="column-227 w-col w-col-6">
							  {% set count = [1] %}
							  {% for host in hosts %}
								  {% set hostnames = db.select_ip_hostnames(host['id']) %}
								  {% set ports = db.select_host_ports(host['id'], full=True) %}
								  {% for hostname in hostnames %}
									  {% for port in ports %}
										  {% if count.append(count.pop() + 1) %} {% endif %}
										  <label class="w-checkbox" id="hostname_row">
											  <input type="checkbox" id="checkbox-10" name="host_port-{{count[0]}}" data-name="Checkbox 10" class="w-checkbox-input" value="{{port['id']}}:{{hostname['id']}}"  {% if 'service' in request.args and request.args['service']==port['id'] and 'hostname' in request.args and request.args['hostname']==hostname['id'] %}checked{% endif %} />
											  <span class="checkbox-label-6 w-form-label">{{escape(hostname['hostname'])}}{% if port['port'] !=0 %}:{{port['port']}}{% if not port['is_tcp'] %} (udp) {% endif %}</span>
										  </label>
									  {% endfor %}
								  {% endfor %}
							  {% endfor %}
						  </div>
                        </div>
                      </div>
                    </div>
					</div>
                    <div class="column-225 w-clearfix w-col w-col-6">
                      <div class="div-block-16 w-clearfix">
					  <label for="path" class="field-label-17">URL path (for web)</label>
					  <input type="text" class="text-field-4 w-input" maxlength="256" name="url" data-name="path" placeholder="/admin/" id="path"  />
					  <label for="cvss-2" class="field-label-21">CVSS</label>
					  <input type="number" class="text-field-5 w-input" maxlength="256" name="cvss" step="0.01" min="0" max="10" data-name="Cvss" placeholder="0.0 - 10.0" id="cvss" value="0" />
					  <label for="cve" class="field-label-22">CVE number</label>
					  <input type="text" class="text-field-5 w-input" maxlength="256" name="cve" data-name="cve" placeholder="2020-1337" id="cve"  />
					  <label for="cwe" class="field-label-23">CWE number</label>
					  <input type="number" min="0" class="text-field-5 w-input" maxlength="256" name="cwe" data-name="cwe" placeholder="123" id="cwe"  />
					  <label for="status" class="field-label-20">Status</label>
					  <select id="status" name="status" data-name="Status" required="" class="select-field-3 w-select">
					  <option value="PoC creation">PoC creation</option>
					  <option value="PoC available">PoC available</option>
					  <option value="Confirmed">Confirmed</option>
					  <option value="Not comfirmed">Wasn&#x27;t comfirmed</option>
					  <option value="Pending...">Pending...</option>
					  <option value="Need to recheck">Need to recheck</option>
					  <option value="Need to check">Need to check</option>
					  </select>
					  <label for="status-2" class="field-label-20">Criticality</label>
					  <select id="status-2" name="criticality" data-name="Status 2" class="select-field-3 w-select">
						  <option value="-1">use CVSS criticality</option>
						  <option value="0">Information (cvss=0.0)</option>
						  <option value="2">Low (cvss=2.0)</option>
						  <option value="5">Medium (cvss=5.0)</option>
						  <option value="8">High (cvss=8.0)</option>
						  <option value="9.5">Critical (cvss=9.5)</option>
					  </select>
					  <label for="param" class="field-label-20">Parameter</label>
					  <input type="text" class="text-field-40 w-input" maxlength="256" name="param" data-name="param" placeholder="GET id=123" id="param">
					  <label for="type" class="field-label-35">Type</label>
					  <select id="type" name="issue_type" data-name="type" class="select-field-16 w-select">
						  <option value="custom">Custom</option>
						  <option value="web">Web</option>
						  <option value="credentials">Credentials</option>
						  <option value="service">Service</option>
					  </select>
					  </div>
					  <input type="submit" value="Submit" data-wait="Please wait..." class="submit-button-11 w-button" />
					  </div>
                  </div>
                </form>
				  {% if errors is defined and errors != [] %}
					  {% for error in errors %}
						<div class="error-message w-form-fail" style="display: block">
							<div>{{error}}</div>
						</div>
					  {% endfor %}
				  {% endif %}
      </div>
    </div>
  </div>
  {% include 'footer.html' %}
</body>
</html>